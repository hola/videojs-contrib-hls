/*! videojs-contrib-hls - v1.0.0-21 - 2016-03-19
* Copyright (c) 2016 Brightcove; Licensed  */
!function(a,b){var c=function(){this.init=function(){var a={};this.on=function(b,c){a[b]||(a[b]=[]),a[b].push(c)},this.off=function(b,c){var d;return a[b]?(d=a[b].indexOf(c),a[b].splice(d,1),d>-1):!1},this.trigger=function(b){var c,d,e,f;if(c=a[b])if(2===arguments.length)for(e=c.length,d=0;e>d;++d)c[d].call(this,arguments[1]);else{for(f=[],d=arguments.length,d=1;d<arguments.length;++d)f.push(arguments[d]);for(e=c.length,d=0;e>d;++d)c[d].apply(this,f)}},this.dispose=function(){a={}}}};c.prototype.pipe=function(a){return this.on("data",function(b){a.push(b)}),this.on("done",function(){a.flush()}),a},c.prototype.push=function(a){this.trigger("data",a)},c.prototype.flush=function(){this.trigger("done")},a.muxjs=a.muxjs||{},a.muxjs.Stream=c}(this),function(a,b){b.ExpGolomb=function(a){var b=a.byteLength,c=0,d=0;this.length=function(){return 8*b},this.bitsAvailable=function(){return 8*b+d},this.loadWord=function(){var e=a.byteLength-b,f=new Uint8Array(4),g=Math.min(4,b);if(0===g)throw new Error("no bytes available");f.set(a.subarray(e,e+g)),c=new DataView(f.buffer).getUint32(0),d=8*g,b-=g},this.skipBits=function(a){var e;d>a?(c<<=a,d-=a):(a-=d,e=Math.floor(a/8),a-=8*e,b-=e,this.loadWord(),c<<=a,d-=a)},this.readBits=function(a){var e=Math.min(d,a),f=c>>>32-e;return console.assert(32>a,"Cannot read more than 32 bits at a time"),d-=e,d>0?c<<=e:b>0&&this.loadWord(),e=a-e,e>0?f<<e|this.readBits(e):f},this.skipLeadingZeros=function(){var a;for(a=0;d>a;++a)if(0!==(c&2147483648>>>a))return c<<=a,d-=a,a;return this.loadWord(),a+this.skipLeadingZeros()},this.skipUnsignedExpGolomb=function(){this.skipBits(1+this.skipLeadingZeros())},this.skipExpGolomb=function(){this.skipBits(1+this.skipLeadingZeros())},this.readUnsignedExpGolomb=function(){var a=this.skipLeadingZeros();return this.readBits(a+1)-1},this.readExpGolomb=function(){var a=this.readUnsignedExpGolomb();return 1&a?1+a>>>1:-1*(a>>>1)},this.readBoolean=function(){return 1===this.readBits(1)},this.readUnsignedByte=function(){return this.readBits(8)},this.loadWord()}}(this,this.muxjs),function(a){a.videojs=a.videojs||{},a.muxjs=a.muxjs||{};var b=a.muxjs;b.FlvTag=function(a,c){var d,e=0,f=function(a,b){var c,d=a.position+b;d<a.bytes.byteLength||(c=new Uint8Array(2*d),c.set(a.bytes.subarray(0,a.position),0),a.bytes=c,a.view=new DataView(a.bytes.buffer))},g=b.FlvTag.widthBytes||new Uint8Array("width".length),h=b.FlvTag.heightBytes||new Uint8Array("height".length),i=b.FlvTag.videocodecidBytes||new Uint8Array("videocodecid".length);if(!b.FlvTag.widthBytes){for(d=0;d<"width".length;d++)g[d]="width".charCodeAt(d);for(d=0;d<"height".length;d++)h[d]="height".charCodeAt(d);for(d=0;d<"videocodecid".length;d++)i[d]="videocodecid".charCodeAt(d);b.FlvTag.widthBytes=g,b.FlvTag.heightBytes=h,b.FlvTag.videocodecidBytes=i}switch(this.keyFrame=!1,a){case b.FlvTag.VIDEO_TAG:this.length=16;break;case b.FlvTag.AUDIO_TAG:this.length=13,this.keyFrame=!0;break;case b.FlvTag.METADATA_TAG:this.length=29,this.keyFrame=!0;break;default:throw"Error Unknown TagType"}this.bytes=new Uint8Array(16384),this.view=new DataView(this.bytes.buffer),this.bytes[0]=a,this.position=this.length,this.keyFrame=c,this.pts=0,this.dts=0,this.writeBytes=function(a,b,c){var d,e=b||0;c=c||a.byteLength,d=e+c,f(this,c),this.bytes.set(a.subarray(e,d),this.position),this.position+=c,this.length=Math.max(this.length,this.position)},this.writeByte=function(a){f(this,1),this.bytes[this.position]=a,this.position++,this.length=Math.max(this.length,this.position)},this.writeShort=function(a){f(this,2),this.view.setUint16(this.position,a),this.position+=2,this.length=Math.max(this.length,this.position)},this.negIndex=function(a){return this.bytes[this.length-a]},this.nalUnitSize=function(){return 0===e?0:this.length-(e+4)},this.startNalUnit=function(){if(e>0)throw new Error("Attempted to create new NAL wihout closing the old one");e=this.length,this.length+=4,this.position=this.length},this.endNalUnit=function(a){var b,c;this.length===e+4?this.length-=4:e>0&&(b=e+4,c=this.length-b,this.position=e,this.view.setUint32(this.position,c),this.position=this.length,a&&a.push(this.bytes.subarray(b,b+c))),e=0},this.writeMetaDataDouble=function(a,b){var c;if(f(this,2+a.length+9),this.view.setUint16(this.position,a.length),this.position+=2,"width"===a)this.bytes.set(g,this.position),this.position+=5;else if("height"===a)this.bytes.set(h,this.position),this.position+=6;else if("videocodecid"===a)this.bytes.set(i,this.position),this.position+=12;else for(c=0;c<a.length;c++)this.bytes[this.position]=a.charCodeAt(c),this.position++;this.position++,this.view.setFloat64(this.position,b),this.position+=8,this.length=Math.max(this.length,this.position),++e},this.writeMetaDataBoolean=function(a,b){var c;for(f(this,2),this.view.setUint16(this.position,a.length),this.position+=2,c=0;c<a.length;c++)console.assert(a.charCodeAt(c)<255),f(this,1),this.bytes[this.position]=a.charCodeAt(c),this.position++;f(this,2),this.view.setUint8(this.position,1),this.position++,this.view.setUint8(this.position,b?1:0),this.position++,this.length=Math.max(this.length,this.position),++e},this.finalize=function(){var a,d;switch(this.bytes[0]){case b.FlvTag.VIDEO_TAG:this.bytes[11]=7|(this.keyFrame||c?16:32),this.bytes[12]=c?0:1,a=this.pts-this.dts,this.bytes[13]=(16711680&a)>>>16,this.bytes[14]=(65280&a)>>>8,this.bytes[15]=(255&a)>>>0;break;case b.FlvTag.AUDIO_TAG:this.bytes[11]=175,this.bytes[12]=c?0:1;break;case b.FlvTag.METADATA_TAG:this.position=11,this.view.setUint8(this.position,2),this.position++,this.view.setUint16(this.position,10),this.position+=2,this.bytes.set([111,110,77,101,116,97,68,97,116,97],this.position),this.position+=10,this.bytes[this.position]=8,this.position++,this.view.setUint32(this.position,e),this.position=this.length,this.bytes.set([0,0,9],this.position),this.position+=3,this.length=this.position}return d=this.length-11,this.bytes[1]=(16711680&d)>>>16,this.bytes[2]=(65280&d)>>>8,this.bytes[3]=(255&d)>>>0,this.bytes[4]=(16711680&this.dts)>>>16,this.bytes[5]=(65280&this.dts)>>>8,this.bytes[6]=(255&this.dts)>>>0,this.bytes[7]=(4278190080&this.dts)>>>24,this.bytes[8]=0,this.bytes[9]=0,this.bytes[10]=0,f(this,4),this.view.setUint32(this.length,this.length),this.length+=4,this.position+=4,this.bytes=this.bytes.subarray(0,this.length),this.frameTime=b.FlvTag.frameTime(this.bytes),console.assert(this.bytes.byteLength===this.length),this}},b.FlvTag.AUDIO_TAG=8,b.FlvTag.VIDEO_TAG=9,b.FlvTag.METADATA_TAG=18,b.FlvTag.isAudioFrame=function(a){return b.FlvTag.AUDIO_TAG===a[0]},b.FlvTag.isVideoFrame=function(a){return b.FlvTag.VIDEO_TAG===a[0]},b.FlvTag.isMetaData=function(a){return b.FlvTag.METADATA_TAG===a[0]},b.FlvTag.isKeyFrame=function(a){return b.FlvTag.isVideoFrame(a)?23===a[11]:b.FlvTag.isAudioFrame(a)?!0:b.FlvTag.isMetaData(a)?!0:!1},b.FlvTag.frameTime=function(a){var b=a[4]<<16;return b|=a[5]<<8,b|=a[6]<<0,b|=a[7]<<24}}(this),function(){var a,b=window.muxjs.ExpGolomb,c=window.muxjs.FlvTag;window.muxjs.H264ExtraData=a=function(){this.sps=[],this.pps=[]},a.prototype.extraDataExists=function(){return this.sps.length>0},a.prototype.scaling_list=function(a,b){var c,d,e=8,f=8;for(c=0;a>c;++c)0!==f&&(d=b.readExpGolomb(),f=(e+d+256)%256),e=0===f?e:f},a.prototype.getSps0Rbsp=function(){for(var a=this.sps[0],b=1,c=1,d=0,e=a.byteLength-2,f=new Uint8Array(a.byteLength);e>b;)0===a[b]&&0===a[b+1]&&3===a[b+2]&&(f.set(a.subarray(c,b+1),d),d+=b+1-c,c=b+3),b++;return f.set(a.subarray(c),d),f.subarray(0,d+(a.byteLength-c))},a.prototype.metaDataTag=function(a){var d,e,f,g,h,i,j,k,l,m,n,o,p,q=new c(c.METADATA_TAG),r=0,s=0,t=0,u=0;if(q.dts=a,q.pts=a,d=new b(this.getSps0Rbsp()),e=d.readUnsignedByte(),d.skipBits(16),d.skipUnsignedExpGolomb(),(100===e||110===e||122===e||244===e||44===e||83===e||86===e||118===e||128===e)&&(f=d.readUnsignedExpGolomb(),3===f&&d.skipBits(1),d.skipUnsignedExpGolomb(),d.skipUnsignedExpGolomb(),d.skipBits(1),d.readBoolean()))for(g=3!==f?8:12,h=0;g>h;++h)d.readBoolean()&&(6>h?this.scaling_list(16,d):this.scaling_list(64,d));if(d.skipUnsignedExpGolomb(),i=d.readUnsignedExpGolomb(),0===i)d.readUnsignedExpGolomb();else if(1===i)for(d.skipBits(1),d.skipExpGolomb(),d.skipExpGolomb(),j=d.readUnsignedExpGolomb(),h=0;j>h;++h)d.skipExpGolomb();return d.skipUnsignedExpGolomb(),d.skipBits(1),k=d.readUnsignedExpGolomb(),l=d.readUnsignedExpGolomb(),m=d.readBits(1),0===m&&d.skipBits(1),d.skipBits(1),n=d.readBoolean(),n&&(r=d.readUnsignedExpGolomb(),s=d.readUnsignedExpGolomb(),t=d.readUnsignedExpGolomb(),u=d.readUnsignedExpGolomb()),o=16*(k+1)-2*r-2*s,p=(2-m)*(l+1)*16-2*t-2*u,q.writeMetaDataDouble("videocodecid",7),q.writeMetaDataDouble("width",o),q.writeMetaDataDouble("height",p),q},a.prototype.extraDataTag=function(a){var b,d=new c(c.VIDEO_TAG,!0);for(d.dts=a,d.pts=a,d.writeByte(1),d.writeByte(this.sps[0][1]),d.writeByte(this.sps[0][2]),d.writeByte(this.sps[0][3]),d.writeByte(255),d.writeByte(225),d.writeShort(this.sps[0].length),d.writeBytes(this.sps[0]),d.writeByte(this.pps.length),b=0;b<this.pps.length;++b)d.writeShort(this.pps[b].length),d.writeBytes(this.pps[b]);return d}}(),function(a){var b=a.muxjs.FlvTag,c=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3];a.muxjs.AacStream=function(){var a,d,e,f,g,h,i,j,k,l,m,n,o;this.tags=[],this.setTimeStampOffset=function(a){f=a-1e3},this.setNextTimeStamp=function(b,c,f){a=b,e=c,f&&(d=0)},this.writeBytes=function(p,q,r){var s,t,u;for(q=q||0,r=r||0,r=r>e?e:r,e-=r,s=q+r;s>q;)switch(d){default:d=0;break;case 0:if(q>=s)return;if(255!==p[q])return console.assert(!1,"Error no ATDS header found"),q+=1,void(d=0);q+=1,d=1;break;case 1:if(q>=s)return;if(240!==(240&p[q]))return console.assert(!1,"Error no ATDS header found"),q+=1,void(d=0);g=!!(1&p[q]),q+=1,d=2;break;case 2:if(q>=s)return;h=((192&p[q])>>>6)+1,i=(60&p[q])>>>2,j=(1&p[q])<<2,q+=1,d=3;break;case 3:if(q>=s)return;j|=(192&p[q])>>>6,k=(3&p[q])<<11,q+=1,d=4;break;case 4:if(q>=s)return;k|=p[q]<<3,q+=1,d=5;break;case 5:if(q>=s)return;k|=(224&p[q])>>>5,k-=g?7:9,q+=1,d=6;break;case 6:if(q>=s)return;l=1024*((3&p[q])+1),m=1e3*l/c[i],t=h<<11|i<<7|j<<3,(t!==o||a-f>=1e3)&&(n=new b(b.METADATA_TAG),n.pts=a,n.dts=a,n.writeMetaDataDouble("audiocodecid",10),n.writeMetaDataBoolean("stereo",2===j),n.writeMetaDataDouble("audiosamplerate",c[i]),n.writeMetaDataDouble("audiosamplesize",16),this.tags.push(n),o=t,n=new b(b.AUDIO_TAG,!0),n.pts=a,n.dts=n.pts,n.view.setUint16(n.position,t),n.position+=2,n.length=Math.max(n.length,n.position),this.tags.push(n),f=a),q+=1,d=7;break;case 7:if(!g){if(2>s-q)return;q+=2}n=new b(b.AUDIO_TAG),n.pts=a,n.dts=a,d=8;break;case 8:for(;k;){if(q>=s)return;u=k>s-q?s-q:k,n.writeBytes(p,q,u),q+=u,k-=u}this.tags.push(n),d=0,a+=m}}}}(this),function(a){var b,c,d=a.muxjs.FlvTag,e=a.muxjs.H264ExtraData;a.muxjs.NALUnitType=c={unspecified:0,slice_layer_without_partitioning_rbsp_non_idr:1,slice_data_partition_a_layer_rbsp:2,slice_data_partition_b_layer_rbsp:3,slice_data_partition_c_layer_rbsp:4,slice_layer_without_partitioning_rbsp_idr:5,sei_rbsp:6,seq_parameter_set_rbsp:7,pic_parameter_set_rbsp:8,access_unit_delimiter_rbsp:9,end_of_seq_rbsp:10,end_of_stream_rbsp:11},a.muxjs.H264Stream=b=function(){this._next_pts=0,this._next_dts=0,this._h264Frame=null,this._oldExtraData=new e,this._newExtraData=new e,this._nalUnitType=-1,this._state=0,this.tags=[]},b.prototype.setTimeStampOffset=function(){},b.prototype.setNextTimeStamp=function(a,b,c){this._next_pts=a,this._next_dts=b,c&&this.finishFrame()},b.prototype.finishFrame=function(){this._h264Frame&&(this._newExtraData.extraDataExists()&&(this._oldExtraData=this._newExtraData,this._newExtraData=new e),this._oldExtraData.extraDataExists()&&(this._h264Frame.keyFrame||0===this.tags.length)&&(this.tags.push(this._oldExtraData.metaDataTag(this._h264Frame.pts)),this.tags.push(this._oldExtraData.extraDataTag(this._h264Frame.pts))),this._h264Frame.endNalUnit(),this.tags.push(this._h264Frame)),this._h264Frame=null,this._nalUnitType=-1,this._state=0},b.prototype.writeBytes=function(a,b,e){var f,g,h,i;if(b=b||0,e=e||0,!(0>=e))switch(this._state){default:case 0:this._state=1;case 1:if(a[b]<=1&&(f=this._h264Frame?this._h264Frame.nalUnitSize():0,f>=1&&0===this._h264Frame.negIndex(1))){if(1===a[b]&&f>=2&&0===this._h264Frame.negIndex(2))return f>=3&&0===this._h264Frame.negIndex(3)?this._h264Frame.length-=3:this._h264Frame.length-=2,this._state=3,this.writeBytes(a,b+1,e-1);if(e>1&&0===a[b]&&1===a[b+1])return f>=2&&0===this._h264Frame.negIndex(2)?this._h264Frame.length-=2:this._h264Frame.length-=1,this._state=3,this.writeBytes(a,b+2,e-2);if(e>2&&0===a[b]&&0===a[b+1]&&1===a[b+2])return this._state=3,this.writeBytes(a,b+3,e-3)}this._state=2;case 2:for(g=b,h=g+e,i=h-3;i>b;)if(a[b+2]>1)b+=3;else if(0!==a[b+1])b+=2;else if(0!==a[b])b+=1;else{if(1===a[b+2])return b>g&&this._h264Frame&&this._h264Frame.writeBytes(a,g,b-g),this._state=3,b+=3,this.writeBytes(a,b,h-b);if(h-b>=4&&0===a[b+2]&&1===a[b+3])return b>g&&this._h264Frame&&this._h264Frame.writeBytes(a,g,b-g),this._state=3,b+=4,this.writeBytes(a,b,h-b);b+=3}return this._state=1,void(this._h264Frame&&this._h264Frame.writeBytes(a,g,e));case 3:if(this._h264Frame)switch(this._nalUnitType){case c.seq_parameter_set_rbsp:this._h264Frame.endNalUnit(this._newExtraData.sps);break;case c.pic_parameter_set_rbsp:this._h264Frame.endNalUnit(this._newExtraData.pps);break;case c.slice_layer_without_partitioning_rbsp_idr:this._h264Frame.endNalUnit();break;default:this._h264Frame.endNalUnit()}return this._nalUnitType=31&a[b],this._h264Frame&&(this._nalUnitType===c.access_unit_delimiter_rbsp?this.finishFrame():this._nalUnitType===c.slice_layer_without_partitioning_rbsp_idr&&(this._h264Frame.keyFrame=!0)),this._h264Frame||(this._h264Frame=new d(d.VIDEO_TAG),this._h264Frame.pts=this._next_pts,this._h264Frame.dts=this._next_dts),this._h264Frame.startNalUnit(),this._state=2,this.writeBytes(a,b,e)}}}(this),function(a,b,c){"use strict";var d,e=function(a,b,c){var d,e="";for(d=b;c>d;d++)e+="%"+("00"+a[d].toString(16)).slice(-2);return e},f=function(b,c,d){return a.decodeURIComponent(e(b,c,d))},g=function(b,c,d){return a.unescape(e(b,c,d))},h={TXXX:function(a){var b;if(3===a.data[0])for(b=1;b<a.data.length;b++)if(0===a.data[b]){a.description=f(a.data,1,b),a.value=f(a.data,b+1,a.data.length-1);break}},WXXX:function(a){var b;if(3===a.data[0])for(b=1;b<a.data.length;b++)if(0===a.data[b]){a.description=f(a.data,1,b),a.url=f(a.data,b+1,a.data.length);break}},PRIV:function(a){var b;for(b=0;b<a.data.length;b++)if(0===a.data[b]){a.owner=g(a.data,0,b);break}a.privateData=a.data.subarray(b+1)}};d=function(a){var c,e={debug:!(!a||!a.debug),descriptor:a&&a.descriptor},f=0,g=[],i=0;if(d.prototype.init.call(this),this.dispatchType=b.SegmentParser.STREAM_TYPES.metadata.toString(16),e.descriptor)for(c=0;c<e.descriptor.length;c++)this.dispatchType+=("00"+e.descriptor[c].toString(16)).slice(-2);this.push=function(a){var b,c,d,j,k;if(0===g.length&&(a.data.length<10||a.data[0]!=="I".charCodeAt(0)||a.data[1]!=="D".charCodeAt(0)||a.data[2]!=="3".charCodeAt(0)))return void(e.debug&&console.log("Skipping unrecognized metadata packet"));if(g.push(a),i+=a.data.byteLength,1===g.length&&(f=a.data[6]<<21|a.data[7]<<14|a.data[8]<<7|a.data[9],f+=10),!(f>i)){for(b={data:new Uint8Array(f),frames:[],pts:g[0].pts,dts:g[0].dts},k=0;f>k;)b.data.set(g[0].data,k),k+=g[0].data.byteLength,i-=g[0].data.byteLength,g.shift();c=10,64&b.data[5]&&(c+=4,c+=b.data[10]<<24|b.data[11]<<16|b.data[12]<<8|b.data[13],f-=b.data[16]<<24|b.data[17]<<16|b.data[18]<<8|b.data[19]);do{if(d=b.data[c+4]<<24|b.data[c+5]<<16|b.data[c+6]<<8|b.data[c+7],1>d)return console.log("Malformed ID3 frame encountered. Skipping metadata parsing.");j={id:String.fromCharCode(b.data[c],b.data[c+1],b.data[c+2],b.data[c+3]),data:b.data.subarray(c+10,c+d+10)},h[j.id]&&h[j.id](j),b.frames.push(j),c+=10,c+=d}while(f>c);this.trigger("data",b)}}},d.prototype=new b.Stream,b.MetadataStream=d}(window,window.muxjs),function(a){var b,c,d=muxjs.FlvTag,e=muxjs.H264Stream,f=muxjs.AacStream,g=muxjs.MetadataStream;muxjs.SegmentParser=function(){var a,h=this,i=new Uint8Array(b),j=0,k=new e,l=new f;h.stream={programMapTable:{}},h.metadataStream=new g,h.getFlvHeader=function(a,b,c){var e,f,g,h=new Uint8Array(9),i=new DataView(h.buffer);return a=a||0,b=void 0===b?!0:b,c=void 0===c?!0:c,i.setUint8(0,70),i.setUint8(1,76),i.setUint8(2,86),i.setUint8(3,1),i.setUint8(4,(b?4:0)|(c?1:0)),i.setUint32(5,h.byteLength),0>=a?(f=new Uint8Array(h.byteLength+4),f.set(h),f.set([0,0,0,0],h.byteLength),f):(e=new d(d.METADATA_TAG),e.pts=e.dts=0,e.writeMetaDataDouble("duration",a),g=e.finalize().length,f=new Uint8Array(h.byteLength+g),f.set(h),f.set(i.byteLength,g),f)},h.flushTags=function(){k.finishFrame()},h.tagsAvailable=function(){return k.tags.length+l.tags.length},h.getNextTag=function(){var a;return a=k.tags.length?l.tags.length&&l.tags[0].dts<k.tags[0].dts?l.tags.shift():k.tags.shift():l.tags.shift(),a.finalize()},h.parseSegmentBinaryData=function(c){var d,e=0;if(j>0){if(c.byteLength+j<b)return console.log("data.length + streamBuffer.length < MP2T_PACKET_LENGTH ??"),void i.readBytes(c,c.length,i.length);d=c.subarray(0,b-j),i.set(d,j),a(i),i=new Uint8Array(b),j=0}for(;;){for(;e<c.byteLength&&71!==c[e];)e++;if(c.byteLength-e<b)return void(c.byteLength-e>0&&(i.set(c.subarray(e),j),j+=c.byteLength-e));a(c.subarray(e,e+b))?e+=b:(console.log("error parsing m2ts packet, attempting to re-align"),e++)}},a=function(a){var d,e,f,g,i,j,m,n,o,p,q,r,s,t,u,v,w,x,y=0,z=y+b,A=!!(64&a[y+1]),B=(31&a[y+1])<<8|a[y+2],C=(48&a[y+3])>>>4;if(y+=4,C>1&&(y+=a[y]+1),0===B){if(A&&(y+=1+a[y]),d=a[y],0!==d&&console.log("the table_id of the PAT should be 0x00 but was"+d.toString(16)),e=!!(1&a[y+5]))for(f=(15&a[y+1])<<8|a[y+2],y+=8,j=y+(f-5-4);j>y;y+=4)if(g=a[y]<<8|a[y+1],i=(31&a[y+2])<<8|a[y+3],0===g)h.stream.networkPid=i;else if(void 0===h.stream.pmtPid)h.stream.pmtPid=i;else if(h.stream.pmtPid!==i)throw new Error("TS has more that 1 program")}else if(B===h.stream.programMapTable[c.h264]||B===h.stream.programMapTable[c.adts]||B===h.stream.programMapTable[c.metadata]){if(A){if(0!==a[y+0]||0!==a[y+1]||1!==a[y+2])throw new Error("PES did not begin with start code");m=a[y+4]<<8|a[y+5],n=0!==(4&a[y+6]),o=a[y+7],p=a[y+8],y+=9,192&o&&(q=(14&a[y+0])<<28|(255&a[y+1])<<21|(254&a[y+2])<<13|(255&a[y+3])<<6|(254&a[y+4])>>>2,q/=45,r=q,64&o&&(r=(14&a[y+5])<<28|(255&a[y+6])<<21|(254&a[y+7])<<13|(255&a[y+8])<<6|(254&a[y+9])>>>2,r/=45)),y+=p,B===h.stream.programMapTable[c.h264]?k.setNextTimeStamp(q,r,n):B===h.stream.programMapTable[c.adts]&&l.setNextTimeStamp(q,m,n)}B===h.stream.programMapTable[c.adts]?l.writeBytes(a,y,z-y):B===h.stream.programMapTable[c.h264]?k.writeBytes(a,y,z-y):B===h.stream.programMapTable[c.metadata]&&h.metadataStream.push({pts:q,dts:r,data:a.subarray(y)})}else if(h.stream.pmtPid===B){if(A&&(y+=1+a[y]),2!==a[y]&&console.log("The table_id of a PMT should be 0x02 but was "+a[y].toString(16)),s=!!(1&a[y+5]))for(h.stream.programMapTable={},u=(15&a[y+1])<<8|a[y+2],t=(15&a[y+10])<<8|a[y+11],u-=t,u-=13,h.stream.programMapTable.pcrPid=(31&a[y+8])<<8|a[y+9],y+=12+t;u>0;){if(v=a[y+0],w=(31&a[y+1])<<8|a[y+2],v===c.h264&&h.stream.programMapTable[v]&&h.stream.programMapTable[v]!==w)throw new Error("Program has more than 1 video stream");if(v===c.adts&&h.stream.programMapTable[v]&&h.stream.programMapTable[v]!==w)throw new Error("Program has more than 1 audio Stream");h.stream.programMapTable[v]=w,x=(15&a[y+3])<<8|a[y+4],v===c.metadata&&(h.metadataStream.descriptor=new Uint8Array(a.subarray(y+5,y+5+x))),y+=5+x,u-=5+x}}else h.stream.networkPid===B||17===B||8191===B||h.stream.programMapTable.pcrPid||console.log("Unknown PID parsing TS packet: "+B);return!0},h.getTags=function(){return k.tags},h.stats={h264Tags:function(){return k.tags.length},minVideoPts:function(){return k.tags[0].pts},maxVideoPts:function(){return k.tags[k.tags.length-1].pts},aacTags:function(){return l.tags.length},minAudioPts:function(){return l.tags[0].pts},maxAudioPts:function(){return l.tags[l.tags.length-1].pts}}},muxjs.SegmentParser.MP2T_PACKET_LENGTH=b=188,muxjs.SegmentParser.STREAM_TYPES=c={h264:27,adts:15,metadata:21},muxjs.mp2t=muxjs.mp2t||{},muxjs.mp2t.H264_STREAM_TYPE=c.h264,muxjs.mp2t.ADTS_STREAM_TYPE=c.adts,muxjs.mp2t.METADATA_STREAM_TYPE=c.metadata}(window),function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l=0,m=videojs.EventTarget,n="blob:vjs-media-source/";k=a.WebKitDataCue||a.VTTCue,j=function(a){Object.defineProperties(a.frame,{id:{get:function(){return videojs.log.warn("cue.frame.id is deprecated. Use cue.value.key instead."),a.value.key}},value:{get:function(){return videojs.log.warn("cue.frame.value is deprecated. Use cue.value.data instead."),a.value.data}},privateData:{get:function(){return videojs.log.warn("cue.frame.privateData is deprecated. Use cue.value.data instead."),a.value.data}}})},d={mode:"auto"},videojs.MediaSource=videojs.extend(m,{constructor:function(b){var c;return this.settings_=videojs.mergeOptions(d,b),"auto"===this.settings_.mode&&videojs.MediaSource.supportsNativeMediaSources()||"html5"===this.settings_.mode?(c=new a.MediaSource,f(c),c.addEventListener("sourceopen",function(){var a=document.querySelector('[src="'+c.url_+'"]');(a||!a.parentNode)&&(c.player_=videojs(a.parentNode))}),c):new videojs.FlashMediaSource}}),videojs.MediaSource.supportsNativeMediaSources=function(){return!!a.MediaSource},f=function(a){a.virtualBuffers=[],a.addSourceBuffer_=a.addSourceBuffer,a.addSourceBuffer=g},g=function(a){var b,c;return/^video\/mp2t/i.test(a)?(c=a.split(";").slice(1).join(";"),c=c.replace(/avc1\.(\d+)\.(\d+)/i,function(a,b,c){var d=("00"+Number(b).toString(16)).slice(-2),e=("00"+Number(c).toString(16)).slice(-2);return"avc1."+d+"00"+e}),b=new e(this,c),this.virtualBuffers.push(b),b):this.addSourceBuffer_(a)},h=function(a,b,c){return function(){return a[b]&&a[b].updating?void 0:a.trigger(c)}},e=videojs.extend(m,{constructor:function(a,b){var c=this;this.timestampOffset_=0,this.pendingBuffers_=[],this.bufferUpdating_=!1,this.transmuxer_=new Worker(URL.createObjectURL(new Blob(['var muxjs={},transmuxer,initOptions={};!function(a,b){b.ExpGolomb=function(a){var b=a.byteLength,c=0,d=0;this.length=function(){return 8*b},this.bitsAvailable=function(){return 8*b+d},this.loadWord=function(){var e=a.byteLength-b,f=new Uint8Array(4),g=Math.min(4,b);if(0===g)throw new Error("no bytes available");f.set(a.subarray(e,e+g)),c=new DataView(f.buffer).getUint32(0),d=8*g,b-=g},this.skipBits=function(a){var e;d>a?(c<<=a,d-=a):(a-=d,e=Math.floor(a/8),a-=8*e,b-=e,this.loadWord(),c<<=a,d-=a)},this.readBits=function(a){var e=Math.min(d,a),f=c>>>32-e;return console.assert(32>a,"Cannot read more than 32 bits at a time"),d-=e,d>0?c<<=e:b>0&&this.loadWord(),e=a-e,e>0?f<<e|this.readBits(e):f},this.skipLeadingZeros=function(){var a;for(a=0;d>a;++a)if(0!==(c&2147483648>>>a))return c<<=a,d-=a,a;return this.loadWord(),a+this.skipLeadingZeros()},this.skipUnsignedExpGolomb=function(){this.skipBits(1+this.skipLeadingZeros())},this.skipExpGolomb=function(){this.skipBits(1+this.skipLeadingZeros())},this.readUnsignedExpGolomb=function(){var a=this.skipLeadingZeros();return this.readBits(a+1)-1},this.readExpGolomb=function(){var a=this.readUnsignedExpGolomb();return 1&a?1+a>>>1:-1*(a>>>1)},this.readBoolean=function(){return 1===this.readBits(1)},this.readUnsignedByte=function(){return this.readBits(8)},this.loadWord()}}(this,this.muxjs),function(a,b,c){"use strict";function d(a){return[a>>>24&255,a>>>16&255,a>>>8&255,255&a]}function e(a){return[a>>>8&255,255&a]}var f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C,D,E,F,G,H,I,J,K,L,M,N,O,P,Q,R,S,T;S=a.Uint8Array,T=a.DataView,function(){var a;E={avc1:[],avcC:[],btrt:[],dinf:[],dref:[],edts:[],elst:[],esds:[],ftyp:[],hdlr:[],mdat:[],mdhd:[],mdia:[],mfhd:[],minf:[],moof:[],moov:[],mp4a:[],mvex:[],mvhd:[],sdtp:[],smhd:[],stbl:[],stco:[],stsc:[],stsd:[],stsz:[],stts:[],styp:[],tfdt:[],tfhd:[],traf:[],trak:[],trun:[],trex:[],tkhd:[],vmhd:[]};for(a in E)E.hasOwnProperty(a)&&(E[a]=[a.charCodeAt(0),a.charCodeAt(1),a.charCodeAt(2),a.charCodeAt(3)]);F=new S(["i".charCodeAt(0),"s".charCodeAt(0),"o".charCodeAt(0),"m".charCodeAt(0)]),H=new S(["a".charCodeAt(0),"v".charCodeAt(0),"c".charCodeAt(0),"1".charCodeAt(0)]),G=new S([0,0,0,1]),I=new S([0,0,0,0,0,0,0,0,118,105,100,101,0,0,0,0,0,0,0,0,0,0,0,0,86,105,100,101,111,72,97,110,100,108,101,114,0]),J=new S([0,0,0,0,0,0,0,0,115,111,117,110,0,0,0,0,0,0,0,0,0,0,0,0,83,111,117,110,100,72,97,110,100,108,101,114,0]),K={video:I,audio:J},N=new S([0,0,0,0,0,0,0,1,0,0,0,12,117,114,108,32,0,0,0,1]),M=new S([0,0,0,0,0,0,0,0]),O=new S([0,0,0,0,0,0,0,0]),P=O,Q=new S([0,0,0,0,0,0,0,0,0,0,0,0]),R=O,L=new S([0,0,0,1,0,0,0,0,0,0,0,0])}(),f=function(a){var b,c,d,e=[],f=0;for(b=1;b<arguments.length;b++)e.push(arguments[b]);for(b=e.length;b--;)f+=e[b].byteLength;for(c=new S(f+8),d=new T(c.buffer,c.byteOffset,c.byteLength),d.setUint32(0,c.byteLength),c.set(a,4),b=0,f=8;b<e.length;b++)c.set(e[b],f),f+=e[b].byteLength;return c},g=function(){return f(E.dinf,f(E.dref,N))},j=function(a){return f(E.edts,k(a))},k=function(a){var b,c=a.edit_list.length,g=[0,0,0,0].concat(d(c));for(b=0;c>b;b++)g=g.concat(d(a.edit_list[b].segment_duration)).concat(d(a.edit_list[b].media_time)).concat(e(a.edit_list[b].media_rate)).concat(e(0));return f(E.elst,new S(g))},h=function(a){return f(E.esds,new S([0,0,0,0,3,25,0,0,0,4,17,64,21,0,6,0,0,0,218,192,0,0,218,192,5,2,a.audioobjecttype<<3|a.samplingfrequencyindex>>>1,a.samplingfrequencyindex<<7|a.channelcount<<3,6,1,2]))},i=function(a){a=a||{};var b=a.compatible||[F,H];return b=b.slice(0),b.unshift(E.ftyp,a.major||F,G),f.apply(null,b)},w=function(a){return f(E.hdlr,K[a])},l=function(a){return f(E.mdat,a)},v=function(a){var b=new S([0,0,0,0,0,0,0,2,0,0,0,3,0,1,95,144,a.duration>>>24&255,a.duration>>>16&255,a.duration>>>8&255,255&a.duration,85,196,0,0]);return a.samplerate&&(b[12]=a.samplerate>>>24&255,b[13]=a.samplerate>>>16&255,b[14]=a.samplerate>>>8&255,b[15]=255&a.samplerate),f(E.mdhd,b)},u=function(a){return f(E.mdia,v(a),w(a.type),n(a))},m=function(a){return f(E.mfhd,new S([0,0,0,0,(4278190080&a)>>24,(16711680&a)>>16,(65280&a)>>8,255&a]))},n=function(a){return f(E.minf,"video"===a.type?f(E.vmhd,L):f(E.smhd,M),g(),y(a))},o=function(a,b,c){var d=[],e=b.length;for(c=c||{};e--;)d[e]=B(b[e],c);return f.apply(null,[E.moof,m(a)].concat(d))},p=function(a,b){var c=a.length,d=[],e=0;for(b=b||{};c--;)d[c]=s(a[c]),b.set_duration&&(e=Math.max(e,Math.floor(9e4*a[c].duration/a[c].samplerate)));return e=b.duration||e||4294967295,f.apply(null,[E.moov,r(e)].concat(d).concat(q(a)))},q=function(a){for(var b=a.length,c=[];b--;)c[b]=C(a[b]);return f.apply(null,[E.mvex].concat(c))},r=function(a){var b=new S([0,0,0,0,0,0,0,1,0,0,0,2,0,1,95,144,(4278190080&a)>>24,(16711680&a)>>16,(65280&a)>>8,255&a,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,255,255,255,255]);return f(E.mvhd,b)},x=function(a){var b,c,d=a.samples||[],e=new S(4+d.length);for(c=0;c<d.length;c++)b=d[c].flags,e[c+4]=b.dependsOn<<4|b.isDependedOn<<2|b.hasRedundancy;return f(E.sdtp,e)},y=function(a){return f(E.stbl,z(a),f(E.stts,R),f(E.stsc,P),f(E.stsz,Q),f(E.stco,O))},function(){var a,b;z=function(c){return f(E.stsd,new S([0,0,0,0,0,0,0,1]),"video"===c.type?a(c):b(c))},a=function(a){var b,c=a.sps||[],d=a.pps||[],e=[],g=[];for(b=0;b<c.length;b++)e.push((65280&c[b].byteLength)>>>8),e.push(255&c[b].byteLength),e=e.concat(Array.prototype.slice.call(c[b]));for(b=0;b<d.length;b++)g.push((65280&d[b].byteLength)>>>8),g.push(255&d[b].byteLength),g=g.concat(Array.prototype.slice.call(d[b]));return f(E.avc1,new S([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,(65280&a.width)>>8,255&a.width,(65280&a.height)>>8,255&a.height,0,72,0,0,0,72,0,0,0,0,0,0,0,1,19,118,105,100,101,111,106,115,45,99,111,110,116,114,105,98,45,104,108,115,0,0,0,0,0,0,0,0,0,0,0,0,0,24,17,17]),f(E.avcC,new S([1,a.profileIdc,a.profileCompatibility,a.levelIdc,255].concat([224|c.length]).concat(e).concat([d.length]).concat(g))),f(E.btrt,new S([0,28,156,128,0,45,198,192,0,45,198,192])))},b=function(a){return f(E.mp4a,new S([0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,(65280&a.channelcount)>>8,255&a.channelcount,(65280&a.samplesize)>>8,255&a.samplesize,0,0,0,0,(65280&a.samplerate)>>8,255&a.samplerate,0,0]),h(a))}}(),A=function(){return f(E.styp,F,G,F)},t=function(a){var b=a.duration;a.samplerate&&(b=Math.floor(9e4*b/a.samplerate));var c=new S([0,0,0,7,0,0,0,0,0,0,0,0,(4278190080&a.id)>>24,(16711680&a.id)>>16,(65280&a.id)>>8,255&a.id,0,0,0,0,(4278190080&a.duration)>>24,(16711680&a.duration)>>16,(65280&a.duration)>>8,255&a.duration,0,0,0,0,0,0,0,0,0,0,0,0,+("audio"==a.type),0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,64,0,0,0,(65280&a.width)>>8,255&a.width,0,0,(65280&a.height)>>8,255&a.height,0,0]);return f(E.tkhd,c)},B=function(a,b){var c,d,e,g,h;return b=b||{},c=f(E.tfhd,new S([0,b.no_multi_init?2:0,0,58,(4278190080&a.id)>>24,(16711680&a.id)>>16,(65280&a.id)>>8,255&a.id,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0])),d=f(E.tfdt,new S([0,0,0,0,a.baseMediaDecodeTime>>>24&255,a.baseMediaDecodeTime>>>16&255,a.baseMediaDecodeTime>>>8&255,255&a.baseMediaDecodeTime])),h=88,"audio"===a.type?(e=D(a,h),f(E.traf,c,d,e)):(g=x(a),e=D(a,g.length+h),f(E.traf,c,d,e,g))},s=function(a){a.duration=a.duration||4294967295;var b=[E.trak,t(a),u(a)];return a.edit_list&&a.edit_list.length&&b.splice(2,0,j(a)),f.apply(null,b)},C=function(a){var b=new S([0,0,0,0,(4278190080&a.id)>>24,(16711680&a.id)>>16,(65280&a.id)>>8,255&a.id,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,1]);return"video"!==a.type&&(b[b.length-1]=0),f(E.trex,b)},D=function(a,b){function c(a){return("duration"in a&&1)|("size"in a&&2)|("flags"in a&&4)|("compositionTimeOffset"in a&&8)}function d(a,b,c){return[0,0,c,1,(4278190080&a.length)>>>24,(16711680&a.length)>>>16,(65280&a.length)>>>8,255&a.length,(4278190080&b)>>>24,(16711680&b)>>>16,(65280&b)>>>8,255&b]}var e=a.samples||[],g=c(e[0]||{});b+=20+4*e.length*((g>>3&1)+(g>>2&1)+(g>>1&1)+(1&g));for(var h=d(e,b,g),i=0;i<e.length;i++){var j=e[i];1&g&&h.push(j.duration>>24&255,j.duration>>16&255,j.duration>>8&255,255&j.duration),2&g&&h.push(j.size>>24&255,j.size>>16&255,j.size>>8&255,255&j.size),4&g&&h.push(j.flags.isLeading<<2|j.flags.dependsOn,j.flags.isDependedOn<<6|j.flags.hasRedundancy<<4|j.flags.paddingValue<<1|j.flags.isNonSyncSample,j.flags.degradationPriority>>8&255,255&j.flags.degradationPriority),8&g&&h.push(j.compositionTimeOffset>>24&255,j.compositionTimeOffset>>16&255,j.compositionTimeOffset>>8&255,255&j.compositionTimeOffset)}return f(E.trun,new S(h))},b.mp4={ftyp:i,mdat:l,moof:o,moov:p,initSegment:function(a,b){var c,d=i(b),e=p(a,b);return c=new S(d.byteLength+e.byteLength),c.set(d),c.set(e,d.byteLength),c}}}(this,this.muxjs),function(a,b){var c=function(){this.init=function(){var a={};this.on=function(b,c){a[b]||(a[b]=[]),a[b].push(c)},this.off=function(b,c){var d;return a[b]?(d=a[b].indexOf(c),a[b].splice(d,1),d>-1):!1},this.trigger=function(b){var c,d,e,f;if(c=a[b])if(2===arguments.length)for(e=c.length,d=0;e>d;++d)c[d].call(this,arguments[1]);else{for(f=[],d=arguments.length,d=1;d<arguments.length;++d)f.push(arguments[d]);for(e=c.length,d=0;e>d;++d)c[d].apply(this,f)}},this.dispose=function(){a={}}}};c.prototype.pipe=function(a){return this.on("data",function(b){a.push(b)}),this.on("done",function(){a.flush()}),a},c.prototype.push=function(a){this.trigger("data",a)},c.prototype.flush=function(){this.trigger("done")},a.muxjs=a.muxjs||{},a.muxjs.Stream=c}(this),function(a,b,c){"use strict";var d,e=function(a,b,c){var d,e="";for(d=b;c>d;d++)e+="%"+("00"+a[d].toString(16)).slice(-2);return e},f=function(b,c,d){return a.decodeURIComponent(e(b,c,d))},g=function(b,c,d){return a.unescape(e(b,c,d))},h={TXXX:function(a){var b;if(3===a.data[0]){for(b=1;b<a.data.length;b++)if(0===a.data[b]){a.description=f(a.data,1,b),a.value=f(a.data,b+1,a.data.length-1);break}a.data=a.value}},WXXX:function(a){var b;if(3===a.data[0])for(b=1;b<a.data.length;b++)if(0===a.data[b]){a.description=f(a.data,1,b),a.url=f(a.data,b+1,a.data.length);break}},PRIV:function(a){var b;for(b=0;b<a.data.length;b++)if(0===a.data[b]){a.owner=g(a.data,0,b);break}a.privateData=a.data.subarray(b+1),a.data=a.privateData}};d=function(a){var c,e={debug:!(!a||!a.debug),descriptor:a&&a.descriptor},f=0,g=[],i=0;if(d.prototype.init.call(this),this.dispatchType=b.mp2t.METADATA_STREAM_TYPE.toString(16),e.descriptor)for(c=0;c<e.descriptor.length;c++)this.dispatchType+=("00"+e.descriptor[c].toString(16)).slice(-2);this.push=function(a){var b,c,d,j,k;if("timed-metadata"===a.type){if(0===g.length&&(a.data.length<10||a.data[0]!=="I".charCodeAt(0)||a.data[1]!=="D".charCodeAt(0)||a.data[2]!=="3".charCodeAt(0)))return void(e.debug&&console.log("Skipping unrecognized metadata packet"));if(g.push(a),i+=a.data.byteLength,1===g.length&&(f=a.data[6]<<21|a.data[7]<<14|a.data[8]<<7|a.data[9],f+=10),!(f>i)){for(b={data:new Uint8Array(f),frames:[],pts:g[0].pts,dts:g[0].dts},k=0;f>k;)b.data.set(g[0].data,k),k+=g[0].data.byteLength,i-=g[0].data.byteLength,g.shift();c=10,64&b.data[5]&&(c+=4,c+=b.data[10]<<24|b.data[11]<<16|b.data[12]<<8|b.data[13],f-=b.data[16]<<24|b.data[17]<<16|b.data[18]<<8|b.data[19]);do{if(d=b.data[c+4]<<24|b.data[c+5]<<16|b.data[c+6]<<8|b.data[c+7],1>d)return console.log("Malformed ID3 frame encountered. Skipping metadata parsing.");j={id:String.fromCharCode(b.data[c],b.data[c+1],b.data[c+2],b.data[c+3]),data:b.data.subarray(c+10,c+d+10)},j.key=j.id,h[j.id]&&h[j.id](j),b.frames.push(j),c+=10,c+=d}while(f>c);this.trigger("data",b)}}}},d.prototype=new b.Stream,b.mp2t=b.mp2t||{},b.mp2t.MetadataStream=d}(this,this.muxjs),function(a,b,c){"use strict";var d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w;q=188,v=71,r=27,s=15,t=21,u=[96e3,88200,64e3,48e3,44100,32e3,24e3,22050,16e3,12e3,11025,8e3,7350],w=b.mp4,d=function(){var a=new Uint8Array(q),b=0;d.prototype.init.call(this),this.push=function(c){var d,e=0,f=q;for(b?(d=new Uint8Array(c.byteLength+b),d.set(a),d.set(c,b),b=0):d=c;f<d.byteLength;)d[e]!==v||d[f]!==v?(e++,f++):(this.trigger("data",d.subarray(e,f)),e+=q,f+=q);e<d.byteLength&&(a.set(d.subarray(e),0),b=d.byteLength-e)},this.flush=function(){b===q&&a[0]===v&&(this.trigger("data",a),b=0),this.trigger("done")}},d.prototype=new b.Stream,e=function(){var a,b,d,f,g;e.prototype.init.call(this),g=this,this.packetsWaitingForPmt=[],this.programMapTable=c,a=function(a,c){var e=0;c.payloadUnitStartIndicator&&(e+=a[e]+1),"pat"===c.type?b(a.subarray(e),c):d(a.subarray(e),c)},b=function(a,b){b.section_number=a[7],b.last_section_number=a[8],g.pmtPid=(31&a[10])<<8|a[11],b.pmtPid=g.pmtPid},d=function(a,b){var c,d,e,f;if(1&a[5]){for(g.programMapTable={},c=(15&a[1])<<8|a[2],d=3+c-4,e=(15&a[10])<<8|a[11],f=12+e;d>f;)g.programMapTable[(31&a[f+1])<<8|a[f+2]]=a[f],f+=((15&a[f+3])<<8|a[f+4])+5;for(b.programMapTable=g.programMapTable;g.packetsWaitingForPmt.length;)g.processPes_.apply(g,g.packetsWaitingForPmt.shift())}},f=function(a,b){var c;return b.payloadUnitStartIndicator?(b.dataAlignmentIndicator=0!==(4&a[6]),c=a[7],192&c&&(b.pts=(14&a[9])<<28|(255&a[10])<<21|(254&a[11])<<13|(255&a[12])<<6|(254&a[13])>>>2,b.pts*=2,b.pts+=2&a[13],b.dts=b.pts,64&c&&(b.dts=(14&a[14])<<28|(255&a[15])<<21|(254&a[16])<<13|(255&a[17])<<6|(254&a[18])>>>2,b.dts*=2,b.dts+=2&a[18])),void(b.data=a.subarray(9+a[8]))):void(b.data=a)},this.push=function(b){var d={},e=4;d.payloadUnitStartIndicator=!!(64&b[1]),d.pid=31&b[1],d.pid<<=8,d.pid|=b[2],(48&b[3])>>>4>1&&(e+=b[e]+1),0===d.pid?(d.type="pat",a(b.subarray(e),d),this.trigger("data",d)):d.pid===this.pmtPid?(d.type="pmt",a(b.subarray(e),d),this.trigger("data",d)):this.programMapTable===c?this.packetsWaitingForPmt.push([b,e,d]):this.processPes_(b,e,d)},this.processPes_=function(a,b,c){c.streamType=this.programMapTable[c.pid],c.type="pes",f(a.subarray(b),c),this.trigger("data",c)}},e.prototype=new b.Stream,e.STREAM_TYPES={h264:27,adts:15},f=function(){var a,b={data:[],size:0},c={data:[],size:0},d={data:[],size:0},e=function(b,c){var d,e={type:c,data:new Uint8Array(b.size)},f=0;if(b.data.length){for(e.trackId=b.data[0].pid,e.pts=b.data[0].pts,e.dts=b.data[0].dts;b.data.length;)d=b.data.shift(),e.data.set(d.data,f),f+=d.data.byteLength;b.size=0,a.trigger("data",e)}};f.prototype.init.call(this),a=this,this.push=function(f){({pat:function(){},pes:function(){var a,g;switch(f.streamType){case r:a=b,g="video";break;case s:a=c,g="audio";break;case t:a=d,g="timed-metadata";break;default:return}f.payloadUnitStartIndicator&&e(a,g),a.data.push(f),a.size+=f.data.byteLength},pmt:function(){var b,c,d={type:"metadata",tracks:[]},e=f.programMapTable;for(b in e)e.hasOwnProperty(b)&&(c={timelineStartInfo:{}},c.id=+b,e[b]===r?(c.codec="avc",c.type="video"):e[b]===s&&(c.codec="adts",c.type="audio"),d.tracks.push(c));a.trigger("data",d)}})[f.type]()},this.flush=function(){e(b,"video"),e(c,"audio"),e(d,"timed-metadata"),this.trigger("done")}},f.prototype=new b.Stream,j=function(){var a,b,d=0;j.prototype.init.call(this),a=this,this.push=function(a){var e,f,g,h;if("audio"===a.type)for(b?(h=b,b=new Uint8Array(h.byteLength+a.data.byteLength),b.set(h),b.set(a.data,h.byteLength)):b=a.data;d+5<b.length;)if(255===b[d]&&240===(246&b[d+1])){if(f=2*(1&~b[d+1]),e=(3&b[d+3])<<11|b[d+4]<<3|(224&b[d+5])>>5,g=d+e,b.byteLength<g)return;if(this.trigger("data",{dts:a.dts,audioobjecttype:(b[d+2]>>>6&3)+1,channelcount:(1&b[d+2])<<3|(192&b[d+3])>>>6,samplerate:u[(60&b[d+2])>>>2],samplingfrequencyindex:(60&b[d+2])>>>2,samplesize:16,data:b.subarray(d+7+f,g)}),b.byteLength===g)return void(b=c);b=b.subarray(g),d=0}else d++}},j.prototype=new b.Stream,h=function(a){var b=[],d=0,e=0,f=0;h.prototype.init.call(this),this.push=function(e){n(a,e),a&&a.channelcount===c&&(a.audioobjecttype=e.audioobjecttype,a.channelcount=e.channelcount,a.samplerate=e.samplerate,a.samplingfrequencyindex=e.samplingfrequencyindex,a.samplesize=e.samplesize),b.push(e),d+=e.data.byteLength},this.setEarliestDts=function(a){f=a},this.flush=function(){var c,g,h,i,j,k,l;if(0===d)return void this.trigger("done");for(a.minSegmentDts<f&&(a.minSegmentDts=1/0,b=b.filter(function(b){return b.dts>=f?(a.minSegmentDts=Math.min(a.minSegmentDts,b.dts),!0):(d-=b.data.byteLength,!1)})),h=new Uint8Array(d),a.samples=[],j=0;b.length;)g=b[0],i={size:g.data.byteLength,duration:1024},a.samples.push(i),h.set(g.data,j),j+=g.data.byteLength,b.shift();d=0,k=w.mdat(h),p(a),l=w.moof(e,[a]),c=new Uint8Array(l.byteLength+k.byteLength),e++,c.set(l),c.set(k,l.byteLength),o(a),this.trigger("data",{track:a,boxes:c}),this.trigger("done")}},h.prototype=new b.Stream,l=function(){var a,b,c=0;l.prototype.init.call(this),this.push=function(d){var e;for(b?(e=new Uint8Array(b.byteLength+d.data.byteLength),e.set(b),e.set(d.data,b.byteLength),b=e):b=d.data;c<b.byteLength-3;c++)if(1===b[c+2]){a=c+5;break}for(;a<b.byteLength;)switch(b[a]){case 0:if(0!==b[a-1]){a+=2;break}if(0!==b[a-2]){a++;break}this.trigger("data",b.subarray(c+3,a-2));do a++;while(1!==b[a]&&a<b.length);c=a-2,a+=3;break;case 1:if(0!==b[a-1]||0!==b[a-2]){a+=3;break}this.trigger("data",b.subarray(c+3,a-2)),c=a-2,a+=3;break;default:a+=3}b=b.subarray(c),a-=c,c=0},this.flush=function(){b&&b.byteLength>3&&this.trigger("data",b.subarray(c+3)),b=null,c=0,this.trigger("done")}},l.prototype=new b.Stream,k=function(){var a,c,d,e,f,g,h,i=new l;k.prototype.init.call(this),a=this,this.push=function(a){"video"===a.type&&(c=a.trackId,d=a.pts,e=a.dts,i.push(a))},i.on("data",function(b){var h={trackId:c,pts:d,dts:e,data:b};switch(31&b[0]){case 5:h.nalUnitType="slice_layer_without_partitioning_rbsp_idr";break;case 6:h.nalUnitType="sei_rbsp";break;case 7:h.nalUnitType="seq_parameter_set_rbsp",h.escapedRBSP=f(b.subarray(1)),h.config=g(h.escapedRBSP);break;case 8:h.nalUnitType="pic_parameter_set_rbsp";break;case 9:h.nalUnitType="access_unit_delimiter_rbsp"}a.trigger("data",h)}),i.on("done",function(){a.trigger("done")}),this.flush=function(){i.flush()},h=function(a,b){var c,d,e=8,f=8;for(c=0;a>c;c++)0!==f&&(d=b.readExpGolomb(),f=(e+d+256)%256),e=0===f?e:f},f=function(a){for(var b,c,d=a.byteLength,e=[],f=1;d-2>f;)0===a[f]&&0===a[f+1]&&3===a[f+2]?(e.push(f+2),f+=2):f++;if(0===e.length)return a;b=d-e.length,c=new Uint8Array(b);var g=0;for(f=0;b>f;g++,f++)g===e[0]&&(g++,e.shift()),c[f]=a[g];return c},g=function(a){var c,d,e,f,g,i,j,k,l,m,n,o,p=0,q=0,r=0,s=0;if(c=new b.ExpGolomb(a),d=c.readUnsignedByte(),f=c.readUnsignedByte(),e=c.readUnsignedByte(),c.skipUnsignedExpGolomb(),(100===d||110===d||122===d||244===d||44===d||83===d||86===d||118===d||128===d||138===d||139===d||134===d)&&(g=c.readUnsignedExpGolomb(),3===g&&c.skipBits(1),c.skipUnsignedExpGolomb(),c.skipUnsignedExpGolomb(),c.skipBits(1),c.readBoolean()))for(n=3!==g?8:12,o=0;n>o;o++)c.readBoolean()&&(6>o?h(16,c):h(64,c));if(c.skipUnsignedExpGolomb(),i=c.readUnsignedExpGolomb(),0===i)c.readUnsignedExpGolomb();else if(1===i)for(c.skipBits(1),c.skipExpGolomb(),c.skipExpGolomb(),j=c.readUnsignedExpGolomb(),o=0;j>o;o++)c.skipExpGolomb();return c.skipUnsignedExpGolomb(),c.skipBits(1),k=c.readUnsignedExpGolomb(),l=c.readUnsignedExpGolomb(),m=c.readBits(1),0===m&&c.skipBits(1),c.skipBits(1),c.readBoolean()&&(p=c.readUnsignedExpGolomb(),q=c.readUnsignedExpGolomb(),r=c.readUnsignedExpGolomb(),s=c.readUnsignedExpGolomb()),{profileIdc:d,levelIdc:e,profileCompatibility:f,width:16*(k+1)-2*p-2*q,height:(2-m)*(l+1)*16-2*r-2*s}}},k.prototype=new b.Stream,g=function(a){var b,d,e=0,f=[],h=0;g.prototype.init.call(this),delete a.minPTS,this.push=function(c){n(a,c),"seq_parameter_set_rbsp"!==c.nalUnitType||b||(b=c.config,a.width=b.width,a.height=b.height,a.sps=[c.data],a.profileIdc=b.profileIdc,a.levelIdc=b.levelIdc,a.profileCompatibility=b.profileCompatibility),"pic_parameter_set_rbsp"!==c.nalUnitType||d||(d=c.data,a.pps=[c.data]),f.push(c),h+=c.data.byteLength},this.flush=function(){var g,i,j,k,l,m,n,q,r;if(0!==h){for(n=new Uint8Array(h+4*f.length),q=new DataView(n.buffer),a.samples=[],r={size:0,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0,degradationPriority:0}},m=0;f.length;)i=f[0],"access_unit_delimiter_rbsp"===i.nalUnitType&&(g&&(r.duration=i.dts-g.dts,a.samples.push(r)),r={size:0,flags:{isLeading:0,dependsOn:1,isDependedOn:0,hasRedundancy:0,degradationPriority:0},compositionTimeOffset:i.pts-i.dts},g=i),"slice_layer_without_partitioning_rbsp_idr"===i.nalUnitType&&(r.flags.dependsOn=2),r.size+=4,r.size+=i.data.byteLength,q.setUint32(m,i.data.byteLength),m+=4,n.set(i.data,m),m+=i.data.byteLength,f.shift();a.samples.length&&(r.duration=a.samples[a.samples.length-1].duration),a.samples.push(r),h=0,k=w.mdat(n),p(a),this.trigger("timelineStartInfo",a.timelineStartInfo),j=w.moof(e,[a]),l=new Uint8Array(j.byteLength+k.byteLength),e++,l.set(j),l.set(k,j.byteLength),o(a),this.trigger("data",{track:a,boxes:l}),b=c,d=c,this.trigger("done")}}},g.prototype=new b.Stream,n=function(a,b){"number"==typeof b.pts&&(a.timelineStartInfo.pts===c?a.timelineStartInfo.pts=b.pts:a.timelineStartInfo.pts=Math.min(a.timelineStartInfo.pts,b.pts)),"number"==typeof b.dts&&(a.timelineStartInfo.dts===c?a.timelineStartInfo.dts=b.dts:a.timelineStartInfo.dts=Math.min(a.timelineStartInfo.dts,b.dts),a.minSegmentDts===c?a.minSegmentDts=b.dts:a.minSegmentDts=Math.min(a.minSegmentDts,b.dts),a.maxSegmentDts===c?a.maxSegmentDts=b.dts:a.maxSegmentDts=Math.max(a.maxSegmentDts,b.dts))},o=function(a){delete a.minSegmentDts,delete a.maxSegmentDts},p=function(a){var b,c=9e4;a.baseMediaDecodeTime=a.minSegmentDts-a.timelineStartInfo.dts,"audio"===a.type&&(b=a.samplerate/c,a.baseMediaDecodeTime*=b,a.baseMediaDecodeTime=Math.floor(a.baseMediaDecodeTime))},m=function(a){this.numberOfTracks=0,this.metadataStream=a.metadataStream,"undefined"!=typeof a.remux?this.remuxTracks=!!a.remux:this.remuxTracks=!0,this.pendingTracks=[],this.videoTrack=null,this.pendingBoxes=[],this.pendingCaptions=[],this.pendingMetadata=[],this.pendingBytes=0,m.prototype.init.call(this),this.push=function(a){return a.text?this.pendingCaptions.push(a):a.frames?this.pendingMetadata.push(a):(this.pendingTracks.push(a.track),this.pendingBoxes.push(a.boxes),this.pendingBytes+=a.boxes.byteLength,"video"===a.track.type&&(this.videoTrack=a.track),void("audio"===a.track.type&&(this.audioTrack=a.track)))}},m.prototype=new b.Stream,m.prototype.flush=function(){var a,c,d,e,f=0,g={captions:[],metadata:[]},h=0;if(!(0===this.pendingTracks.length||this.remuxTracks&&this.pendingTracks.length<this.numberOfTracks)){for(this.videoTrack?h=this.videoTrack.timelineStartInfo.pts:this.audioTrack&&(h=this.audioTrack.timelineStartInfo.pts),1===this.pendingTracks.length?g.type=this.pendingTracks[0].type:g.type="combined",d=b.mp4.initSegment(this.pendingTracks,this.options),this.pendingBytes+=d.byteLength,this.pendingBoxes.unshift(d),g.data=new Uint8Array(this.pendingBytes),e=0;e<this.pendingBoxes.length;e++)g.data.set(this.pendingBoxes[e],f),f+=this.pendingBoxes[e].byteLength;for(e=0;e<this.pendingCaptions.length;e++)a=this.pendingCaptions[e],a.startTime=a.startPts-h,a.startTime/=9e4,a.endTime=a.endPts-h,a.endTime/=9e4,g.captions.push(a);for(e=0;e<this.pendingMetadata.length;e++)c=this.pendingMetadata[e],c.cueTime=c.pts-h,c.cueTime/=9e4,g.metadata.push(c);g.metadata.dispatchType=this.metadataStream.dispatchType,this.pendingTracks.length=0,this.videoTrack=null,this.pendingBoxes.length=0,this.pendingCaptions.length=0,this.pendingBytes=0,this.pendingMetadata.length=0,this.trigger("data",g),this.trigger("done")}},i=function(a){var c,l,n,o,p,q,r,s,t,u,v=this;i.prototype.init.call(this),a=a||{},a.input_type=a.input_type||"m2ts",n="m2ts"==a.input_type?new f:new b.MP4ParserStream(a),"m2ts"==a.input_type?(this.metadataStream=new b.mp2t.MetadataStream,a.metadataStream=this.metadataStream,u=new m(a),c=new d,l=new e,p=new j,q=new k,c.pipe(l).pipe(n),n.pipe(q),n.pipe(p),n.pipe(this.metadataStream).pipe(u),b.mp2t.CaptionStream&&(t=new b.mp2t.CaptionStream,q.pipe(t).pipe(u))):(o=new b.MP4BuilderStream(a),n.pipe(o),this.seek=function(a,b){return n.seek(a,b)},this.get_tl=function(a){return n.get_tl(a)},this.appendBuffer=function(a){return n.push(new Uint8Array(a))}),n.on("data",function(b){var c,d,e;if("metadata"===b.type){if("m2ts"!=a.input_type)return void v.trigger("metadata",b);for(c=b.tracks.length;c--;)"video"===b.tracks[c].type?d=b.tracks[c]:"audio"===b.tracks[c].type&&(e=b.tracks[c]);d&&!r&&(u.numberOfTracks++,r=new g(d),r.on("timelineStartInfo",function(a){e&&(e.timelineStartInfo=a,s.setEarliestDts(a.dts))}),q.pipe(r).pipe(u)),e&&!s&&(u.numberOfTracks++,s=new h(e),p.pipe(s).pipe(u))}}),this.push=function(b){return"m2ts"!=a.input_type?n.push(b):void c.push(b)},this.flush=function(){return"m2ts"!=a.input_type?void n.flush():void c.flush()},"m2ts"!=a.input_type?(o.on("data",function(a){v.trigger("data",a)}),o.on("done",function(a){v.trigger("done",a)})):(u.on("data",function(a){v.trigger("data",a)}),u.on("done",function(){v.trigger("done")}))},i.prototype=new b.Stream,b.mp2t=b.mp2t||{},b.mp2t.PAT_PID=0,b.mp2t.MP2T_PACKET_LENGTH=q,b.mp2t.H264_STREAM_TYPE=r,b.mp2t.ADTS_STREAM_TYPE=s,b.mp2t.METADATA_STREAM_TYPE=t,b.mp2t.TransportPacketStream=d,b.mp2t.TransportParseStream=e,b.mp2t.ElementaryStream=f,b.mp2t.VideoSegmentStream=g,b.mp2t.Transmuxer=i,b.mp2t.AacStream=j,b.mp2t.H264Stream=k,b.mp2t.NalByteStream=l}(this,this.muxjs),function(a,b,c){"use strict";var d=4,e=function(a){var b,c={payloadType:-1,payloadSize:0};if(a[1]!==d)return c;for(c.payloadType=d,b=2;b<a.length&&255===a[b];b++)c.payloadSize+=255;return c.payloadSize<<=8,c.payloadSize|=a[b],b++,c.payload=a.subarray(b,b+c.payloadSize),c},f=function(a){return 181!==a.payload[0]?null:49!==(a.payload[1]<<8|a.payload[2])?null:"GA94"!==String.fromCharCode(a.payload[3],a.payload[4],a.payload[5],a.payload[6])?null:3!==a.payload[7]?null:a.payload.subarray(8,a.payload.length-1)},g=function(a,b){var c,d,e,f,g=[];if(!(64&b[0]))return g;for(d=31&b[0],c=0;d>c;c++)e=3*c,f={type:3&b[e+2],pts:a},4&b[e+2]&&(f.ccData=b[e+3]<<8|b[e+4],g.push(f));return g},h=function(){h.prototype.init.call(this),this.field1_=new v,this.field1_.on("data",this.trigger.bind(this,"data"))};h.prototype=new b.Stream,h.prototype.push=function(a){var b,c,h,i;if("sei_rbsp"===a.nalUnitType&&(b=e(a.data),b.payloadType===d&&(c=f(b))))for(h=g(a.pts,c),i=0;i<h.length;i++)0===h[i].type&&this.field1_.push(h[i])};var i={92:233,94:237,95:243,96:250,123:231,124:247,125:209,126:241,42:225,127:9608},j=0,k=5152,l=5167,m=5157,n=5158,o=5159,p=5165,q=5153,r=5164,s=5166,t=14,u=function(){for(var a=[],b=t+1;b--;)a.push("");return a},v=function(){v.prototype.init.call(this),this.mode_="popOn",this.topRow_=0,this.startPts_=0,this.displayed_=u(),this.nonDisplayed_=u(),this.push=function(a){var b,c,d;switch(b=32639&a.ccData){case j:break;case k:this.mode_="popOn";break;case l:this.flushDisplayed(a.pts),c=this.displayed_,this.displayed_=this.nonDisplayed_,this.nonDisplayed_=c,this.startPts_=a.pts;break;case m:this.topRow_=t-1,this.mode_="rollUp";break;case n:this.topRow_=t-2,this.mode_="rollUp";break;case o:this.topRow_=t-3,this.mode_="rollUp";break;case p:this.flushDisplayed(a.pts),this.shiftRowsUp_(),this.startPts_=a.pts;break;case q:"popOn"===this.mode_?this.nonDisplayed_[t]=this.nonDisplayed_[t].slice(0,-1):this.displayed_[t]=this.displayed_[t].slice(0,-1);break;case r:this.flushDisplayed(a.pts),this.displayed_=u();break;case s:this.nonDisplayed_=u();break;default:if(d=b>>>8,16===(240&d))return;this[this.mode_](a.pts,d,255&b)}}};v.prototype=new b.Stream,v.prototype.flushDisplayed=function(a){var b,c;for(c=0;c<this.displayed_.length;c++)b=this.displayed_[c],b.length&&this.trigger("data",{startPts:this.startPts_,endPts:a,text:b})},v.prototype.popOn=function(a,b,c){var d=this.nonDisplayed_[t];b=i[b]||b,d+=String.fromCharCode(b),c=i[c]||c,d+=String.fromCharCode(c),this.nonDisplayed_[t]=d},v.prototype.rollUp=function(a,b,c){var d=this.displayed_[t];""===d&&(this.flushDisplayed(a),this.startPts_=a),b=i[b]||b,d+=String.fromCharCode(b),c=i[c]||c,d+=String.fromCharCode(c),this.displayed_[t]=d},v.prototype.shiftRowsUp_=function(){var a;for(a=0;a<this.topRow_;a++)this.displayed_[a]="";for(a=this.topRow_;t>a;a++)this.displayed_[a]=this.displayed_[a+1];this.displayed_[t]=""},b.mp2t=b.mp2t||{},b.mp2t.CaptionStream=h,b.mp2t.Cea608Stream=v}(this,this.muxjs);var wireTransmuxerEvents=function(a){a.on("data",function(a){a.data=a.data.buffer,postMessage({action:"data",segment:a},[a.data])}),a.captionStream&&a.captionStream.on("data",function(a){postMessage({action:"caption",data:a})}),a.on("done",function(a){postMessage({action:"done"})})},messageHandlers={init:function(a){initOptions=a&&a.options||{},this.defaultInit()},defaultInit:function(){transmuxer=new muxjs.mp2t.Transmuxer(initOptions),wireTransmuxerEvents(transmuxer)},push:function(a){var b=new Uint8Array(a.data);transmuxer.push(b)},resetTransmuxer:function(a){transmuxer.dispose(),this.defaultInit()},flush:function(a){transmuxer.flush()}};onmessage=function(a){transmuxer||"init"===a.data.action||messageHandlers.defaultInit(),a.data&&a.data.action&&messageHandlers[a.data.action]&&messageHandlers[a.data.action](a.data)};'],{
type:"application/javascript"}))),this.transmuxer_.onmessage=function(d){if("data"===d.data.action){var e=d.data.segment;return e.data=new Uint8Array(e.data),"video"===e.type?c.videoBuffer_||(c.videoBuffer_=a.addSourceBuffer_("video/mp4;"+(b||"codecs=avc1.4d400d")),c.videoBuffer_.timestampOffset=c.timestampOffset_,c.videoBuffer_.addEventListener("updatestart",h(c,"audioBuffer_","updatestart")),c.videoBuffer_.addEventListener("update",h(c,"audioBuffer_","update")),c.videoBuffer_.addEventListener("updateend",h(c,"audioBuffer_","updateend"))):"audio"===e.type?c.audioBuffer_||(c.audioBuffer_=a.addSourceBuffer_("audio/mp4;"+(b||"codecs=mp4a.40.2")),c.audioBuffer_.timestampOffset=c.timestampOffset_,c.audioBuffer_.addEventListener("updatestart",h(c,"videoBuffer_","updatestart")),c.audioBuffer_.addEventListener("update",h(c,"videoBuffer_","update")),c.audioBuffer_.addEventListener("updateend",h(c,"videoBuffer_","updateend"))):"combined"===e.type&&(c.videoBuffer_||(c.videoBuffer_=a.addSourceBuffer_("video/mp4;"+(b||"codecs=avc1.4d400d, mp4a.40.2")),c.videoBuffer_.timestampOffset=c.timestampOffset_,c.videoBuffer_.addEventListener("updatestart",h(c,"videoBuffer_","updatestart")),c.videoBuffer_.addEventListener("update",h(c,"videoBuffer_","update")),c.videoBuffer_.addEventListener("updateend",h(c,"videoBuffer_","updateend")))),e.captions&&e.captions.length&&!c.inbandTextTrack_&&(c.inbandTextTrack_=a.player_.addTextTrack("captions")),e.metadata&&e.metadata.length&&!c.metadataTrack_&&(c.metadataTrack_=a.player_.addTextTrack("metadata","Timed Metadata"),c.metadataTrack_.inBandMetadataTrackDispatchType=e.metadata.dispatchType),void c.pendingBuffers_.push(e)}return"done"===d.data.action?void c.processPendingSegments_():void 0},Object.defineProperty(this,"timestampOffset",{get:function(){return this.timestampOffset_},set:function(a){"number"==typeof a&&a>=0&&(this.timestampOffset_=a,this.videoBuffer_&&(this.videoBuffer_.timestampOffset=a),this.audioBuffer_&&(this.audioBuffer_.timestampOffset=a),this.transmuxer_.postMessage({action:"resetTransmuxer"}))}}),Object.defineProperty(this,"updating",{get:function(){return this.bufferUpdating_||this.audioBuffer_&&this.audioBuffer_.updating||this.videoBuffer_&&this.videoBuffer_.updating}}),Object.defineProperty(this,"buffered",{get:function(){var a=null,b=null,c=0,d=[],e=[];if(!(this.videoBuffer_&&0!==this.videoBuffer_.buffered.length||this.audioBuffer_&&0!==this.audioBuffer_.buffered.length))return videojs.createTimeRange();if(!this.videoBuffer_)return this.audioBuffer_.buffered;if(!this.audioBuffer_)return this.audioBuffer_.buffered;for(var f=this.videoBuffer_.buffered,g=this.audioBuffer_.buffered,h=f.length;h--;)d.push({time:f.start(h),type:"start"}),d.push({time:f.end(h),type:"end"});for(h=g.length;h--;)d.push({time:g.start(h),type:"start"}),d.push({time:g.end(h),type:"end"});for(d.sort(function(a,b){return a.time-b.time}),h=0;h<d.length;h++)"start"===d[h].type?(c++,2===c&&(a=d[h].time)):"end"===d[h].type&&(c--,1===c&&(b=d[h].time)),null!==a&&null!==b&&(e.push([a,b]),a=null,b=null);return videojs.createTimeRanges(e)}})},appendBuffer:function(a){this.bufferUpdating_=!0,this.transmuxer_.postMessage({action:"push",data:a.buffer},[a.buffer]),this.transmuxer_.postMessage({action:"flush"})},removeCuesFromTrack_:function(a,b,c){var d,e;if(c)for(d=c.cues.length;d--;)e=c.cues[d],e.startTime<=b&&e.endTime>=a&&c.removeCue(e)},remove:function(a,b){this.videoBuffer_&&this.videoBuffer_.remove(a,b),this.audioBuffer_&&this.audioBuffer_.remove(a,b),this.removeCuesFromTrack_(a,b,this.metadataTrack_),this.removeCuesFromTrack_(a,b,this.inbandTextTrack_)},processPendingSegments_:function(){var a={video:{segments:[],bytes:0},audio:{segments:[],bytes:0},captions:[],metadata:[]};a=this.pendingBuffers_.reduce(function(a,b){var c=b.type,d=b.data;return"combined"===c&&(c="video"),a[c].segments.push(d),a[c].bytes+=d.byteLength,b.captions&&(a.captions=a.captions.concat(b.captions)),b.metadata&&(a.metadata=a.metadata.concat(b.metadata)),a},a),a.captions.forEach(function(a){this.inbandTextTrack_.addCue(new VTTCue(a.startTime+this.timestampOffset,a.endTime+this.timestampOffset,a.text))},this),a.metadata.forEach(function(a){var b=a.cueTime+this.timestampOffset;a.frames.forEach(function(a){var c=new k(b,b,a.value||a.url||a.data||"");c.frame=a,c.value=a,j(c),this.metadataTrack_.addCue(c)},this)},this),this.concatAndAppendSegments_(a.video,this.videoBuffer_),this.concatAndAppendSegments_(a.audio,this.audioBuffer_),this.pendingBuffers_.length=0,this.bufferUpdating_=!1},concatAndAppendSegments_:function(a,b){var c,d=0;a.bytes&&(c=new Uint8Array(a.bytes),a.segments.forEach(function(a){c.set(a,d),d+=a.byteLength}),b.appendBuffer(c))},abort:function(){this.videoBuffer_&&this.videoBuffer_.abort(),this.audioBuffer_&&this.audioBuffer_.abort(),this.transmuxer_&&this.transmuxer_.postMessage({action:"resetTransmuxer"}),this.pendingBuffers_.length=0,this.bufferUpdating_=!1}}),videojs.FlashMediaSource=videojs.extend(m,{constructor:function(){var a=this;this.sourceBuffers=[],this.readyState="closed",this.on(["sourceopen","webkitsourceopen"],function(b){this.swfObj=document.getElementById(b.swfId),this.tech_=this.swfObj.tech,this.readyState="open",this.tech_.on("seeking",function(){for(var b=a.sourceBuffers.length;b--;)a.sourceBuffers[b].abort()}),this.swfObj&&this.swfObj.vjs_load()})}}),videojs.FlashMediaSource.BYTES_PER_SECOND_GOAL=4194304,videojs.FlashMediaSource.TICKS_PER_SECOND=60,videojs.FlashMediaSource.prototype.addSourceBuffer=function(a){var b;if(0!==a.indexOf("video/mp2t"))throw new Error("NotSupportedError (Video.js)");return b=new videojs.FlashSourceBuffer(this),this.sourceBuffers.push(b),b};try{Object.defineProperty(videojs.FlashMediaSource.prototype,"duration",{get:function(){return this.swfObj?this.swfObj.vjs_getProperty("duration"):NaN},set:function(a){return this.swfObj.vjs_setProperty("duration",a),a}})}catch(o){videojs.FlashMediaSource.prototype.duration=NaN}videojs.FlashMediaSource.prototype.endOfStream=function(a){"network"===a?this.tech_.error(2):"decode"===a&&this.tech_.error(3),this.readyState="ended"},videojs.mediaSources={},videojs.MediaSource.open=function(a,b){var c=videojs.mediaSources[a];if(!c)throw new Error("Media Source not found (Video.js)");c.trigger({type:"sourceopen",swfId:b})},i=function(b){a.setTimeout(b,Math.ceil(1e3/videojs.FlashMediaSource.TICKS_PER_SECOND))},videojs.FlashSourceBuffer=videojs.extend(m,{constructor:function(c){var d;this.buffer_=[],this.bufferSize_=0,this.basePtsOffset_=NaN,this.source=c,this.updating=!1,this.timestampOffset_=0,this.segmentParser_=new b.SegmentParser,d=a.btoa(String.fromCharCode.apply(null,Array.prototype.slice.call(this.segmentParser_.getFlvHeader()))),this.source.swfObj.vjs_appendBuffer(d),Object.defineProperty(this,"timestampOffset",{get:function(){return this.timestampOffset_},set:function(a){"number"==typeof a&&a>=0&&(this.timestampOffset_=a,this.source.swfObj.vjs_discontinuity(),this.basePtsOffset_=NaN)}}),Object.defineProperty(this,"buffered",{get:function(){return videojs.createTimeRange(0,this.source.swfObj.vjs_getProperty("buffered"))}})},appendBuffer:function(a){var b,c;if(this.updating)throw b=new Error("SourceBuffer.append() cannot be called while an update is in progress"),b.name="InvalidStateError",b.code=11,b;0===this.buffer_.length&&i(this.processBuffer_.bind(this)),this.updating=!0,this.source.readyState="open",this.trigger({type:"update"}),c=this.tsToFlv_(a),this.buffer_.push(c),this.bufferSize_+=c.byteLength},abort:function(){this.buffer_=[],this.bufferSize_=0,this.source.swfObj.vjs_abort(),this.updating&&(this.updating=!1,this.trigger({type:"updateend"}))},remove:function(){this.trigger({type:"update"}),this.trigger({type:"updateend"})},processBuffer_:function(){var b,c,d,e,f,g,h;if(this.buffer_.length){for(f=document.hidden?videojs.FlashMediaSource.BYTES_PER_SECOND_GOAL:Math.ceil(videojs.FlashMediaSource.BYTES_PER_SECOND_GOAL/videojs.FlashMediaSource.TICKS_PER_SECOND),e=new Uint8Array(Math.min(f,this.bufferSize_)),c=e.byteLength;c;)b=this.buffer_[0].subarray(0,c),e.set(b,e.byteLength-c),b.byteLength<this.buffer_[0].byteLength?this.buffer_[0]=this.buffer_[0].subarray(c):this.buffer_.shift(),c-=b.byteLength;for(this.bufferSize_-=e.byteLength,g="",d=e.byteLength,c=0;d>c;c++)g+=String.fromCharCode(e[c]);h=a.btoa(g),this.source.swfObj.CallFunction('<invoke name="vjs_appendBuffer"returntype="javascript"><arguments><string>'+h+"</string></arguments></invoke>"),0!==this.bufferSize_?i(this.processBuffer_.bind(this)):(this.updating=!1,this.trigger({type:"updateend"}),"ended"===this.source.readyState&&this.source.swfObj.vjs_endOfStream())}},tsToFlv_:function(a){var b,c,d,e,f=0,g=[],h=this.source.tech_,i=0;for(this.segmentParser_.parseSegmentBinaryData(a),this.segmentParser_.flushTags();this.segmentParser_.tagsAvailable();)g.push(this.segmentParser_.getNextTag());if(isNaN(this.basePtsOffset_)&&g.length&&(this.basePtsOffset_=g[0].pts),h.seeking())for(e=h.currentTime()-this.timestampOffset,e*=1e3,e+=this.basePtsOffset_;i<g.length&&g[i].pts<e;)i++;for(b=i;b<g.length;b++)f+=g[b].bytes.byteLength;for(d=new Uint8Array(f),b=i,c=0;b<g.length;b++)d.set(g[b].bytes,c),c+=g[b].bytes.byteLength;return d}}),videojs.URL={createObjectURL:function(b){var c;return b instanceof videojs.FlashMediaSource?(c=n+l,l++,videojs.mediaSources[c]=b,c):(c=a.URL.createObjectURL(b),b.url_=c,c)}}}(this,this.muxjs),function(a,b,c,d){"use strict";var e,f,g,h=1.1,i=b.getComponent("Component"),j=500;f=function(a){return a.retries&&a.retries>=2},b.Hls=b.extend(i,{constructor:function(a,c){var d,e=this;i.call(this,a),a.options_&&a.options_.playerId&&(d=b(a.options_.playerId),d.hls||Object.defineProperty(d,"hls",{get:function(){return b.log.warn("player.hls is deprecated. Use player.tech.hls instead."),e}})),this.tech_=a,this.source_=c.source,this.mode_=c.mode,this.pendingSegment_=null,this.bytesReceived=0,this.loadingState_="none","none"!==this.tech_.preload()&&(this.loadingState_="meta"),this.segmentBuffer_=[],this.startCheckingBuffer_(),this.on(this.tech_,"seeking",function(){this.setCurrentTime(this.tech_.currentTime())}),this.on(this.tech_,"play",this.play)}}),b.Hls.canPlaySource=function(){return b.log.warn("HLS is no longer a tech. Please remove it from your player's techOrder.")},b.HlsSourceHandler=function(a){return{canHandleSource:function(a){var c=/^application\/(?:x-|vnd\.apple\.)mpegurl/i;return b.Hls.supportsNativeHls?!1:c.test(a.type)},handleSource:function(c,d){return"flash"===a&&d.setTimeout(function(){d.trigger("loadstart")},1),d.hls=new b.Hls(d,{source:c,mode:a}),d.hls.src(c.src),d.hls}}},b.MediaSource.supportsNativeMediaSources()&&b.getComponent("Html5").registerSourceHandler(b.HlsSourceHandler("html5")),b.getComponent("Flash").registerSourceHandler(b.HlsSourceHandler("flash")),b.Hls.GOAL_BUFFER_LENGTH=30,b.Hls.prototype.src=function(a){var c;a&&(this.mediaSource=new b.MediaSource({mode:this.mode_}),this.segmentBuffer_=[],this.mediaSource.addEventListener("sourceopen",this.handleSourceOpen.bind(this)),this.mediaIndex=0,this.options_={},this.source_.withCredentials!==d?this.options_.withCredentials=this.source_.withCredentials:b.options.hls&&(this.options_.withCredentials=b.options.hls.withCredentials),this.playlists=new b.Hls.PlaylistLoader(this.source_.src,this.options_.withCredentials),this.tech_.one("canplay",this.setupFirstPlay.bind(this)),this.playlists.on("loadedmetadata",function(){var a,b,e,f,g,h,i;c=this.playlists.media(),c.endList&&"metadata"!==this.tech_.preload()&&"none"!==this.tech_.preload()&&(this.loadingState_="segments"),this.bandwidth===d&&this.setBandwidth({bandwidth:5*this.playlists.bandwidth}),this.setupSourceBuffer_(),a=this.selectPlaylist(),e=c.attributes&&c.attributes.BANDWIDTH||0,f=a.attributes&&a.attributes.BANDWIDTH||0,g=c.segments&&c.segments[this.mediaIndex].duration||c.targetDuration,h=g*f/this.bandwidth,h||(h=1/0),i=10,f>e&&i>=h?(this.playlists.media(a),b=function(){this.setupFirstPlay(),this.fillBuffer(),this.tech_.trigger("loadedmetadata"),this.playlists.off("loadedplaylist",b)}.bind(this),this.playlists.on("loadedplaylist",b)):(this.setupFirstPlay(),this.fillBuffer(),this.tech_.trigger("loadedmetadata"))}.bind(this)),this.playlists.on("error",function(){2===this.playlists.error.code?this.mediaSource.endOfStream("network"):4===this.playlists.error.code&&this.mediaSource.endOfStream("decode"),this.tech_.error(this.playlists.error)}.bind(this)),this.playlists.on("loadedplaylist",function(){var a=this.playlists.media();a&&(this.updateDuration(this.playlists.media()),this.mediaIndex=b.Hls.translateMediaIndex(this.mediaIndex,c,a),c=a,this.fetchKeys_())}.bind(this)),this.playlists.on("mediachange",function(){e&&this.cancelKeyXhr(),this.tech_.trigger({type:"mediachange",bubbles:!0})}.bind(this)),this.tech_.el()&&this.tech_.src(b.URL.createObjectURL(this.mediaSource)))},b.Hls.getMediaIndexForLive_=function(a){if(!a.segments)return 0;for(var b=a.segments.length,c=0,d=3*(a.targetDuration||10);d>c&&b>0;)c+=a.segments[b-1].duration,b--;return b},b.Hls.prototype.handleSourceOpen=function(){this.sourceBuffer||this.setupSourceBuffer_(),this.tech_.autoplay()&&this.play()},b.Hls.prototype.setupSourceBuffer_=function(){var a,b=this.playlists.media();b&&"open"===this.mediaSource.readyState&&(a="video/mp2t",b.attributes&&b.attributes.CODECS&&(a+='; codecs="'+b.attributes.CODECS+'"'),this.sourceBuffer=this.mediaSource.addSourceBuffer(a),this.sourceBuffer.addEventListener("updateend",function(){var a,b,c=this.pendingSegment_;if(this.pendingSegment_=null,this.duration()!==1/0&&this.mediaIndex===this.playlists.media().segments.length&&this.mediaSource.endOfStream(),2===this.tech_.buffered().length&&c.playlist===this.playlists.media())for(a=this.tech_.buffered().length;a--;)if(this.tech_.currentTime()<this.tech_.buffered().start(a)){b=this.findCurrentBuffered_(),this.playlists.updateTimelineOffset(c.mediaIndex,this.tech_.buffered().start(a)),this.mediaIndex=this.playlists.getMediaIndexForTime_(b.end(0)+1);break}}.bind(this)))},b.Hls.prototype.setupMetadataCueTranslation_=function(){var a,c=this.segmentParser_.metadataStream;c.on("data",function(d){var e,f;if(!a)for(a=this.tech_.addTextTrack("metadata","Timed Metadata"),a.inBandMetadataTrackDispatchType=b.Hls.SegmentParser.STREAM_TYPES.metadata.toString(16).toUpperCase(),e=0;e<c.descriptor.length;e++)f=("00"+c.descriptor[e].toString(16).toUpperCase()).slice(-2),a.inBandMetadataTrackDispatchType+=f;this.tech_.segmentBuffer_[0].pendingMetadata.push({textTrack:a,metadata:d})}.bind(this)),this.on(this.tech_,"seeking",function(){var c,d,e;if(a)for(c=this.playlists.media(),d=this.tech_.playlists.expired_,d+=b.Hls.Playlist.duration(c,c.mediaSequence,c.mediaSequence+this.tech_.mediaIndex),e=a.cues.length;e--;)a.cues[e].startTime>=d&&a.removeCue(a.cues[e])})},b.Hls.prototype.addCuesForMetadata_=function(c){var d,e,f,g,h,i,j,k,l;for(j=this.playlists.expired_,j+=b.Hls.Playlist.duration(c.playlist,c.playlist.mediaSequence,c.playlist.mediaSequence+c.mediaIndex),i=c.playlist.segments[c.mediaIndex],h=Math.min(isFinite(i.minVideoPts)?i.minVideoPts:1/0,isFinite(i.minAudioPts)?i.minAudioPts:1/0);c.pendingMetadata.length;){for(g=c.pendingMetadata[0].metadata,k=c.pendingMetadata[0].textTrack,d=0;d<g.frames.length;d++)f=g.frames[d],l=j+.001*(g.pts-h),e=new a.VTTCue(l,l,f.value||f.url||""),e.frame=f,e.pts_=g.pts,k.addCue(e);c.pendingMetadata.shift()}},b.Hls.prototype.setupFirstPlay=function(){var a,b;b=this.playlists.media(),this.duration()===1/0&&0===this.tech_.played().length&&!this.tech_.paused()&&this.sourceBuffer&&b&&this.tech_.readyState()>=1&&(a=this.seekable(),a.length&&this.tech_.setCurrentTime(a.end(0)))},b.Hls.prototype.play=function(){return this.loadingState_="segments",this.tech_.ended()&&(this.mediaIndex=0),0===this.tech_.played().length?this.setupFirstPlay():void(this.duration()===1/0&&this.tech_.currentTime()<this.tech_.seekable().start(0)&&this.tech_.setCurrentTime(this.tech_.seekable().start(0)))},b.Hls.prototype.setCurrentTime=function(a){var b=this.findCurrentBuffered_();return this.playlists&&this.playlists.media()&&this.playlists.media().segments?b&&b.length?a:(this.mediaIndex=this.playlists.getMediaIndexForTime_(a),this.cancelSegmentXhr(),e&&(e.aborted=!0,this.cancelKeyXhr()),this.segmentBuffer_=[],void this.fillBuffer(1e3*a)):0},b.Hls.prototype.duration=function(){var a=this.playlists;return a?b.Hls.Playlist.duration(a.media()):0},b.Hls.prototype.seekable=function(){var a,c,d;return this.playlists&&(d=this.playlists.media())?(a=b.Hls.Playlist.seekable(d),a.length?(c=this.playlists.expired_,b.createTimeRanges(c,c+(a.end(0)-a.start(0)))):a):b.createTimeRanges()},b.Hls.prototype.updateDuration=function(a){var c=this.mediaSource.duration,d=b.Hls.Playlist.duration(a),e=function(){this.mediaSource.duration=d,this.tech_.trigger("durationchange"),this.mediaSource.removeEventListener("sourceopen",e)}.bind(this);c!==d&&("open"===this.mediaSource.readyState?(this.mediaSource.duration=d,this.tech_.trigger("durationchange")):this.mediaSource.addEventListener("sourceopen",e))},b.Hls.prototype.resetSrc_=function(){this.cancelSegmentXhr(),this.cancelKeyXhr(),this.sourceBuffer&&this.sourceBuffer.abort()},b.Hls.prototype.cancelKeyXhr=function(){e&&(e.onreadystatechange=null,e.abort(),e=null)},b.Hls.prototype.cancelSegmentXhr=function(){this.segmentXhr_&&(this.segmentXhr_.onreadystatechange=null,this.segmentXhr_.abort(),this.segmentXhr_=null)},b.Hls.prototype.dispose=function(){this.stopCheckingBuffer_(),this.playlists&&this.playlists.dispose(),this.resetSrc_(),i.prototype.dispose.call(this)},b.Hls.prototype.selectPlaylist=function(){var a,c,d,e,f,g,i,j,k=this.playlists.master.playlists.slice(),l=[],m=k.length;for(k.sort(b.Hls.comparePlaylistBandwidth);m--;)c=k[m],c.attributes&&c.attributes.BANDWIDTH&&(a=c.attributes.BANDWIDTH*h,a<this.bandwidth&&(l.push(c),e||(e=c)));for(m=l.length,l.sort(b.Hls.comparePlaylistResolution),c=null,i=parseInt(getComputedStyle(this.tech_.el()).width,10),j=parseInt(getComputedStyle(this.tech_.el()).height,10);m--;)if(d=c,c=l[m],c.attributes&&c.attributes.RESOLUTION&&c.attributes.RESOLUTION.width&&c.attributes.RESOLUTION.height){if(c.attributes.RESOLUTION.width===i&&c.attributes.RESOLUTION.height===j){f=null,g=c;break}if(c.attributes.RESOLUTION.width<i&&c.attributes.RESOLUTION.height<j){d&&d.attributes&&d.attributes.RESOLUTION&&d.attributes.RESOLUTION.width&&d.attributes.RESOLUTION.height&&(f=d),g=c;break}}return f||g||e||k[0]},b.Hls.prototype.checkBuffer_=function(){this.checkBufferTimeout_&&(a.clearTimeout(this.checkBufferTimeout_),this.checkBufferTimeout_=null);try{this.fillBuffer(),this.drainBuffer()}catch(b){var c=a.videojs(this.player().options_.playerId);c.error({message:b,code:4})}this.checkBufferTimeout_=a.setTimeout(this.checkBuffer_.bind(this),j)},b.Hls.prototype.startCheckingBuffer_=function(){this.drainBuffer_=this.drainBuffer.bind(this),this.tech_.on("waiting",this.drainBuffer_),this.checkBuffer_()},b.Hls.prototype.stopCheckingBuffer_=function(){this.checkBufferTimeout_&&(a.clearTimeout(this.checkBufferTimeout_),this.checkBufferTimeout_=null),this.tech_.off("waiting",this.drainBuffer_)},b.Hls.prototype.findCurrentBuffered_=function(){var a,c,d=this.tech_,e=d.currentTime(),f=this.tech_.buffered();if(f&&f.length)for(c=0;c<f.length;c++)if(f.start(c)<=e&&f.end(c)>=e)return a=b.createTimeRanges(f.start(c),f.end(c)),a.indexOf=c,a;return a=b.createTimeRanges(),a.indexOf=-1,a},b.Hls.prototype.fillBuffer=function(a){var c,d,e=this.tech_,f=e.currentTime(),g=this.findCurrentBuffered_(),h=0;"segments"===this.loadingState_&&e.currentSrc()&&this.playlists&&(this.segmentXhr_||"HAVE_NOTHING"!==this.playlists.state&&this.playlists.media()&&this.playlists.media().segments&&"SWITCHING_MEDIA"!==this.playlists.state&&(c=this.playlists.media().segments[this.mediaIndex],c&&(g&&g.length&&(h=Math.max(0,g.end(0)-f)),"number"!=typeof a&&h>=b.Hls.GOAL_BUFFER_LENGTH||(d=this.playlistUriToUrl(c.uri),this.loadSegment(d,a)))))},b.Hls.prototype.playlistUriToUrl=function(a){var b;return b=this.playlists.media().uri===this.source_.src?g(this.source_.src,a):g(g(this.source_.src,this.playlists.media().uri||""),a)},b.Hls.prototype.setBandwidth=function(a){this.segmentXhrTime=a.roundTripTime,this.bandwidth=a.bandwidth,this.bytesReceived+=a.bytesReceived||0,this.tech_.trigger("bandwidthupdate")},b.Hls.prototype.segmentFinished=function(){this.mediaIndex++,this.playlists.media(this.selectPlaylist())},b.Hls.prototype.loadSegment=function(a,c){var d=this;this.segmentXhr_=b.Hls.xhr({uri:a,streaming:!0,responseType:"arraybuffer",withCredentials:this.source_.withCredentials},function(b,e){var f;return"progress"!==e.type&&(d.segmentXhr_=null),e.timedout?(d.bandwidth=1,d.playlists.media(d.selectPlaylist())):!e.aborted&&b?(d.error={status:e.status,message:"HLS segment request error at URL: "+a,code:e.status>=500?4:2},void d.mediaIndex++):e.response?("progress"!==e.type&&d.setBandwidth(e),f={mediaIndex:d.mediaIndex,playlist:d.playlists.media(),offset:c,bytes:null,encryptedBytes:null,decrypter:null,pendingMetadata:[]},f.playlist.segments[f.mediaIndex].key?f.encryptedBytes=new Uint8Array(e.response):f.bytes=new Uint8Array(e.response),d.segmentBuffer_.push(f),d.tech_.trigger("progress"),d.drainBuffer(),void("progress"!==e.type&&d.segmentFinished())):void("final"===e.type&&(d.setBandwidth(e),d.segmentFinished(),d.segmentXhr_=null))})},b.Hls.prototype.drainBuffer=function(a){var c,d,e,g,h,i,j,k,l=0,m=0!==this.tech_.buffered().length,n=this.findCurrentBuffered_(),o=!(n&&n.length),p=this.segmentBuffer_;if(p.length&&this.sourceBuffer&&!this.sourceBuffer.updating){if(c=p[0],d=c.mediaIndex,e=c.playlist,g=c.offset,h=c.bytes,i=e.segments[d],i.key&&!h)return f(i.key)?p.shift():i.key.bytes?c.decrypter?void 0:(k=i.key.iv||new Uint32Array([0,0,0,d+e.mediaSequence]),j=new b.Hls.Decrypter(c.encryptedBytes,i.key.bytes,k,function(a,b){c.bytes=b}),void(c.decrypter=j)):this.fetchKeys_();if(a=a||{},this.addCuesForMetadata_(c),this.tech_.seeking()&&o){if(m)return void this.sourceBuffer.remove(0,1/0);c.playlist.discontinuityStarts.length&&(c.mediaIndex>0&&(l=b.Hls.Playlist.duration(c.playlist,0,c.mediaIndex)),this.sourceBuffer.timestampOffset=l)}else i.discontinuity&&(this.sourceBuffer.timestampOffset=n.end(0));this.sourceBuffer.appendBuffer(h),this.pendingSegment_=p.shift()}},b.Hls.prototype.fetchKeys_=function(){var a,c,d,g,h,i,j,k;if(!e&&this.segmentBuffer_.length)for(d=this,g=this.player(),h=this.options_,k=function(a){return function(b,c){return e=null,b||!c.response||16!==c.response.byteLength?(a.retries=a.retries||0,a.retries++,void(c.aborted||d.fetchKeys_())):(j=new DataView(c.response),a.bytes=new Uint32Array([j.getUint32(0),j.getUint32(4),j.getUint32(8),j.getUint32(12)]),void d.checkBuffer_())}},a=0;a<d.segmentBuffer_.length;a++)if(i=d.segmentBuffer_[a].playlist.segments[d.segmentBuffer_[a].mediaIndex],c=i.key,c&&!c.bytes&&!f(c)){e=b.Hls.xhr({uri:this.playlistUriToUrl(c.uri),responseType:"arraybuffer",withCredentials:h.withCredentials},k(c));break}},b.Hls.supportsNativeHls=function(){var a,d,e=c.createElement("video");return b.getComponent("Html5").isSupported()?(a=e.canPlayType("application/x-mpegURL"),d=e.canPlayType("application/vnd.apple.mpegURL"),/probably|maybe/.test(a)||/probably|maybe/.test(d)):!1}(),b.Hls.isSupported=function(){return b.log.warn("HLS is no longer a tech. Please remove it from your player's techOrder.")},b.Hls.getPlaylistDuration=function(a,c,d){return b.log.warn("videojs.Hls.getPlaylistDuration is deprecated. Use videojs.Hls.Playlist.duration instead"),b.Hls.Playlist.duration(a,c,d)},b.Hls.getPlaylistTotalDuration=function(a){return b.log.warn("videojs.Hls.getPlaylistTotalDuration is deprecated. Use videojs.Hls.Playlist.duration instead"),b.Hls.Playlist.duration(a)},b.Hls.translateMediaIndex=function(a,c,d){var e;return 0===a?0:d&&d.segments?(e=a+(c.mediaSequence-d.mediaSequence),e>d.segments.length||0>e?b.Hls.getMediaIndexForLive_(d)+1:e):0},b.Hls.getMediaIndexByTime=function(){return b.log.warn("getMediaIndexByTime is deprecated. Use PlaylistLoader.getMediaIndexForTime_ instead."),0},b.Hls.comparePlaylistBandwidth=function(b,c){var d,e;return b.attributes&&b.attributes.BANDWIDTH&&(d=b.attributes.BANDWIDTH),d=d||a.Number.MAX_VALUE,c.attributes&&c.attributes.BANDWIDTH&&(e=c.attributes.BANDWIDTH),e=e||a.Number.MAX_VALUE,d-e},b.Hls.comparePlaylistResolution=function(b,c){var d,e;return b.attributes&&b.attributes.RESOLUTION&&b.attributes.RESOLUTION.width&&(d=b.attributes.RESOLUTION.width),d=d||a.Number.MAX_VALUE,c.attributes&&c.attributes.RESOLUTION&&c.attributes.RESOLUTION.width&&(e=c.attributes.RESOLUTION.width),e=e||a.Number.MAX_VALUE,d===e&&b.attributes.BANDWIDTH&&c.attributes.BANDWIDTH?b.attributes.BANDWIDTH-c.attributes.BANDWIDTH:d-e},g=b.Hls.resolveUrl=function(a,b){var d,e,f=c.querySelector("base"),g=c.querySelector("head"),h=c.createElement("a"),i=f;return f?d=f.href:i=g.appendChild(c.createElement("base")),i.href=a,h.href=b,e=h.href,f?f.href=d:g.removeChild(i),e}}(window,window.videojs,document),function(a){"use strict";a.Hls.xhr=function(b,c){b=a.mergeOptions({timeout:45e3},b);var d=a.xhr(b,function(a,b){!a&&d.response&&(d.responseTime=(new Date).getTime(),d.roundTripTime=d.responseTime-d.requestTime,d.bytesReceived=d.response.byteLength||d.response.length,d.bandwidth||(d.bandwidth=Math.floor(d.bytesReceived/d.roundTripTime*8*1e3))),a||d.timedout?d.timedout=d.timedout||"ETIMEDOUT"===a.code:d.timedout=!1,a||200===b.statusCode||0===b.statusCode||(a=new Error("XHR Failed with a response of: "+(d&&(d.response||d.responseText)))),c(a,d)});return d.requestTime=(new Date).getTime(),d}}(window.videojs),function(a,b){var c=function(){this.init=function(){var a={};this.on=function(b,c){a[b]||(a[b]=[]),a[b].push(c)},this.off=function(b,c){var d;return a[b]?(d=a[b].indexOf(c),a[b].splice(d,1),d>-1):!1},this.trigger=function(b){var c,d,e,f;if(c=a[b])if(2===arguments.length)for(e=c.length,d=0;e>d;++d)c[d].call(this,arguments[1]);else for(f=Array.prototype.slice.call(arguments,1),e=c.length,d=0;e>d;++d)c[d].apply(this,f)},this.dispose=function(){a={}}}};c.prototype.pipe=function(a){this.on("data",function(b){a.push(b)})},a.Hls.Stream=c}(window.videojs),function(a,b,c,d,e){var f,g,h,i=function(){},j=function(){var a="[^=]*",b='"[^"]*"|[^,]*',c="(?:"+a+")=(?:"+b+")";return new RegExp("(?:^|,)("+c+")")}(),k=function(a){for(var b,c=a.split(j),d=c.length,e={};d--;)""!==c[d]&&(b=/([^=]*)=(.*)/.exec(c[d]).slice(1),b[0]=b[0].replace(/^\s+|\s+$/g,""),b[1]=b[1].replace(/^\s+|\s+$/g,""),b[1]=b[1].replace(/^['"](.*)['"]$/g,"$1"),e[b[0]]=b[1]);return e},l=a.Hls.Stream;f=function(){var a="";f.prototype.init.call(this),this.push=function(b){var c;for(a+=b,c=a.indexOf("\n");c>-1;c=a.indexOf("\n"))this.trigger("data",a.substring(0,c)),a=a.substring(c+1)}},f.prototype=new l,g=function(){g.prototype.init.call(this)},g.prototype=new l,g.prototype.push=function(a){var c,d;return a=a.replace(/^\s+|\s+$/g,""),0!==a.length?"#"!==a[0]?void this.trigger("data",{type:"uri",uri:a}):0!==a.indexOf("#EXT")?void this.trigger("data",{type:"comment",text:a.slice(1)}):(a=a.replace("\r",""),(c=/^#EXTM3U/.exec(a))?void this.trigger("data",{type:"tag",tagType:"m3u"}):(c=/^#EXTINF:?([0-9\.]*)?,?(.*)?$/.exec(a))?(d={type:"tag",tagType:"inf"},c[1]&&(d.duration=parseFloat(c[1])),c[2]&&(d.title=c[2]),void this.trigger("data",d)):(c=/^#EXT-X-TARGETDURATION:?([0-9.]*)?/.exec(a))?(d={type:"tag",tagType:"targetduration"},c[1]&&(d.duration=b(c[1],10)),void this.trigger("data",d)):(c=/^#ZEN-TOTAL-DURATION:?([0-9.]*)?/.exec(a))?(d={type:"tag",tagType:"totalduration"},c[1]&&(d.duration=b(c[1],10)),void this.trigger("data",d)):(c=/^#EXT-X-VERSION:?([0-9.]*)?/.exec(a))?(d={type:"tag",tagType:"version"},c[1]&&(d.version=b(c[1],10)),void this.trigger("data",d)):(c=/^#EXT-X-MEDIA-SEQUENCE:?(\-?[0-9.]*)?/.exec(a))?(d={type:"tag",tagType:"media-sequence"},c[1]&&(d.number=b(c[1],10)),void this.trigger("data",d)):(c=/^#EXT-X-DISCONTINUITY-SEQUENCE:?(\-?[0-9.]*)?/.exec(a))?(d={type:"tag",tagType:"discontinuity-sequence"},c[1]&&(d.number=b(c[1],10)),void this.trigger("data",d)):(c=/^#EXT-X-PLAYLIST-TYPE:?(.*)?$/.exec(a))?(d={type:"tag",tagType:"playlist-type"},c[1]&&(d.playlistType=c[1]),void this.trigger("data",d)):(c=/^#EXT-X-BYTERANGE:?([0-9.]*)?@?([0-9.]*)?/.exec(a))?(d={type:"tag",tagType:"byterange"},c[1]&&(d.length=b(c[1],10)),c[2]&&(d.offset=b(c[2],10)),void this.trigger("data",d)):(c=/^#EXT-X-ALLOW-CACHE:?(YES|NO)?/.exec(a))?(d={type:"tag",tagType:"allow-cache"},c[1]&&(d.allowed=!/NO/.test(c[1])),void this.trigger("data",d)):(c=/^#EXT-X-STREAM-INF:?(.*)$/.exec(a))?(d={type:"tag",tagType:"stream-inf"},c[1]&&(d.attributes=k(c[1]),d.attributes.RESOLUTION&&!function(){var a=d.attributes.RESOLUTION.split("x"),c={};a[0]&&(c.width=b(a[0],10)),a[1]&&(c.height=b(a[1],10)),d.attributes.RESOLUTION=c}(),d.attributes.BANDWIDTH&&(d.attributes.BANDWIDTH=b(d.attributes.BANDWIDTH,10)),d.attributes["PROGRAM-ID"]&&(d.attributes["PROGRAM-ID"]=b(d.attributes["PROGRAM-ID"],10))),void this.trigger("data",d)):(c=/^#EXT-X-ENDLIST/.exec(a))?void this.trigger("data",{type:"tag",tagType:"endlist"}):(c=/^#EXT-X-DISCONTINUITY/.exec(a))?void this.trigger("data",{type:"tag",tagType:"discontinuity"}):(c=/^#EXT-X-KEY:?(.*)$/.exec(a))?(d={type:"tag",tagType:"key"},c[1]&&(d.attributes=k(c[1]),d.attributes.IV&&("0x"===d.attributes.IV.substring(0,2)&&(d.attributes.IV=d.attributes.IV.substring(2)),d.attributes.IV=d.attributes.IV.match(/.{8}/g),d.attributes.IV[0]=b(d.attributes.IV[0],16),d.attributes.IV[1]=b(d.attributes.IV[1],16),d.attributes.IV[2]=b(d.attributes.IV[2],16),d.attributes.IV[3]=b(d.attributes.IV[3],16),d.attributes.IV=new Uint32Array(d.attributes.IV))),void this.trigger("data",d)):void this.trigger("data",{type:"tag",data:a.slice(4,a.length)})):void 0},h=function(){var a,b=this,j=[],k={};h.prototype.init.call(this),this.lineStream=new f,this.parseStream=new g,this.lineStream.pipe(this.parseStream),this.manifest={allowCache:!0,discontinuityStarts:[]},this.parseStream.on("data",function(f){({tag:function(){(({"allow-cache":function(){this.manifest.allowCache=f.allowed,"allowed"in f||(this.trigger("info",{message:"defaulting allowCache to YES"}),this.manifest.allowCache=!0)},byterange:function(){var a={};"length"in f&&(k.byterange=a,a.length=f.length,"offset"in f||(this.trigger("info",{message:"defaulting offset to zero"}),f.offset=0)),"offset"in f&&(k.byterange=a,a.offset=f.offset)},endlist:function(){this.manifest.endList=!0},inf:function(){"mediaSequence"in this.manifest||(this.manifest.mediaSequence=0,this.trigger("info",{message:"defaulting media sequence to zero"})),"discontinuitySequence"in this.manifest||(this.manifest.discontinuitySequence=0,this.trigger("info",{message:"defaulting discontinuity sequence to zero"})),f.duration>=0&&(k.duration=f.duration),this.manifest.segments=j},key:function(){return f.attributes?"NONE"===f.attributes.METHOD?void(a=null):f.attributes.URI?(f.attributes.METHOD||this.trigger("warn",{message:"defaulting key method to AES-128"}),a={method:f.attributes.METHOD||"AES-128",uri:f.attributes.URI},void(f.attributes.IV!==e&&(a.iv=f.attributes.IV))):void this.trigger("warn",{message:"ignoring key declaration without URI"}):void this.trigger("warn",{message:"ignoring key declaration without attribute list"})},"media-sequence":function(){return c(f.number)?void(this.manifest.mediaSequence=f.number):void this.trigger("warn",{message:"ignoring invalid media sequence: "+f.number})},"discontinuity-sequence":function(){return c(f.number)?void(this.manifest.discontinuitySequence=f.number):void this.trigger("warn",{message:"ignoring invalid discontinuity sequence: "+f.number})},"playlist-type":function(){return/VOD|EVENT/.test(f.playlistType)?void(this.manifest.playlistType=f.playlistType):void this.trigger("warn",{message:"ignoring unknown playlist type: "+f.playlist})},"stream-inf":function(){return this.manifest.playlists=j,f.attributes?(k.attributes||(k.attributes={}),
void(k.attributes=d(k.attributes,f.attributes))):void this.trigger("warn",{message:"ignoring empty stream-inf attributes"})},discontinuity:function(){k.discontinuity=!0,this.manifest.discontinuityStarts.push(j.length)},targetduration:function(){return!c(f.duration)||f.duration<0?void this.trigger("warn",{message:"ignoring invalid target duration: "+f.duration}):void(this.manifest.targetDuration=f.duration)},totalduration:function(){return!c(f.duration)||f.duration<0?void this.trigger("warn",{message:"ignoring invalid total duration: "+f.duration}):void(this.manifest.totalDuration=f.duration)}})[f.tagType]||i).call(b)},uri:function(){k.uri=f.uri,j.push(k),!this.manifest.targetDuration||"duration"in k||(this.trigger("warn",{message:"defaulting segment duration to the target duration"}),k.duration=this.manifest.targetDuration),a&&(k.key=a),k={}},comment:function(){}})[f.type].call(b)})},h.prototype=new l,h.prototype.push=function(a){this.lineStream.push(a)},h.prototype.end=function(){this.lineStream.push("\n")},window.videojs.m3u8={LineStream:f,ParseStream:g,Parser:h}}(window.videojs,window.parseInt,window.isFinite,window.videojs.mergeOptions),function(a,b){"use strict";var c,d,e,f,g,h,i,j,k=10;g=function(a,b){return a=isFinite(a)?a:1/0,b=isFinite(b)?b:1/0,Math.min(a,b)},h=function(a,b){return a=isFinite(a)?a:-(1/0),b=isFinite(b)?b:-(1/0),Math.max(a,b)},d=function(a,b){return a-b},c=function(a,b,c,e){var f,g=[],h=(a.discontinuityStarts||[]).concat(c),j=0;if(b>=c)return 0;for(h.sort(d),f=0;f<h.length;f++)if(h[f]>b){g.push({start:b,end:h[f]}),f++;break}for(;f<h.length;f++){if(h[f]>=c){g.push({start:h[f-1],end:c});break}g.push({start:g[g.length-1].end,end:h[f]})}for(f=0;f<g.length;f++)j+=i(a,g[f],f===g.length-1&&e);return j},i=function(a,b,c){var d,e,f,i=0,j=a.targetDuration||k;for(e=b.start;e<b.end&&(d=a.segments[e],void 0===d.minVideoPts&&void 0===d.minAudioPts);e++)i+=d.duration||j;if(c&&(d=a.segments[b.end],d&&(void 0!==d.minVideoPts||void 0!==d.minAudioPts)))return i+=.001*(g(d.minVideoPts,d.minAudioPts)-g(a.segments[e].minVideoPts,a.segments[e].minAudioPts));for(f=b.end-1;f>=e&&(d=a.segments[f],void 0===d.maxVideoPts&&void 0===d.maxAudioPts);f--)i+=d.duration||j;return f>=e&&(i+=.001*(h(a.segments[f].maxVideoPts,a.segments[f].maxAudioPts)-g(a.segments[e].minVideoPts,a.segments[e].minAudioPts))),i},f=function(a,b,d,e){var f,g,i=0;return void 0===b&&(b=a.mediaSequence||0),void 0===d&&(d=b+(a.segments||[]).length),f=a.targetDuration||k,g=h(a.mediaSequence-b,0),i+=g*f,i+=c(a,b+g-a.mediaSequence,d-a.mediaSequence,e)},e=function(b,c,d,e){if(!b)return 0;if(void 0===e&&(e=!0),void 0===c&&void 0===d){if(b.totalDuration)return b.totalDuration;if(!b.endList)return a.Infinity}return f(b,c,d,e)},j=function(a){var c,d,h,i,j,l,m;if(!a.segments)return b.createTimeRange();if(a.endList)return b.createTimeRange(0,e(a));if(c=0,d=f(a,a.mediaSequence,a.mediaSequence+a.segments.length),i=a.targetDuration||k,!a.endList)for(h=3*i,m=a.segments.length-1;m>=0&&h>0;m--)j=a.segments[m],l=g(e(a,a.mediaSequence+m,a.mediaSequence+m+1),h),h-=l,d-=l;return b.createTimeRange(c,d)},b.Hls.Playlist={duration:e,seekable:j}}(window,window.videojs),function(a,b){"use strict";var c=b.Hls.resolveUrl,d=b.Hls.xhr,e=b.Hls.Playlist,f=b.mergeOptions,g=function(a,b){var c,d,e=!1,g=f(a,{});for(c=a.playlists.length;c--;)if(d=g.playlists[c],d.uri===b.uri){if(d.segments&&b.segments&&d.segments.length===b.segments.length&&d.mediaSequence===b.mediaSequence)continue;g.playlists[c]=f(d,b),g.playlists[b.uri]=g.playlists[c],d.segments&&(g.playlists[c].segments=h(d.segments,b.segments,b.mediaSequence-d.mediaSequence)),e=!0}return e?g:null},h=function(a,b,c){var d,e,g=b.slice();for(c=c||0,d=Math.min(a.length,b.length+c),e=c;d>e;e++)g[e-c]=f(a[e],g[e-c]);return g},i=function(e,f){var h,j,k,l,m=this;if(i.prototype.init.call(this),!e)throw new Error("A non-empty playlist URL is required");l=function(c,d,e){var f,h,i;return m.setBandwidth(k||d),k=null,c?(m.error={status:d.status,message:"HLS playlist request error at URL: "+e,responseText:d.responseText,code:d.status>=500?4:2},m.trigger("error")):(m.state="HAVE_METADATA",f=new b.m3u8.Parser,f.push(d.responseText),f.end(),f.manifest.uri=e,i=g(m.master,f.manifest),h=1e3*(f.manifest.targetDuration||10),i?(m.master=i,m.updateMediaPlaylist_(f.manifest)):h/=2,m.media().endList||(a.clearTimeout(j),j=a.setTimeout(function(){m.trigger("mediaupdatetimeout")},h)),void m.trigger("loadedplaylist"))},m.state="HAVE_NOTHING",m.expired_=0,h=this.dispose,m.dispose=function(){k&&(k.onreadystatechange=null,k.abort(),k=null),a.clearTimeout(j),h.call(this)},m.media=function(a){var b=!1;if(!a)return m.media_;if("HAVE_NOTHING"===m.state||"HAVE_MASTER"===m.state)throw new Error("Cannot switch media playlist from "+m.state);if("string"==typeof a){if(!m.master.playlists[a])throw new Error("Unknown playlist URI: "+a);a=m.master.playlists[a]}if(b=a.uri!==m.media_.uri,m.master.playlists[a.uri].endList)return k&&(k.onreadystatechange=null,k.abort(),k=null),m.state="HAVE_METADATA",m.media_=a,void(b&&m.trigger("mediachange"));if(b){if(m.state="SWITCHING_MEDIA",k){if(c(m.master.uri,a.uri)===k.url)return;k.onreadystatechange=null,k.abort(),k=null}k=d({uri:c(m.master.uri,a.uri),withCredentials:f},function(b,c){l(b,c,a.uri),m.trigger("mediachange")})}},m.setBandwidth=function(a){m.bandwidth=a.bandwidth},m.on("mediaupdatetimeout",function(){"HAVE_METADATA"===m.state&&(m.state="HAVE_CURRENT_METADATA",k=d({uri:c(m.master.uri,m.media().uri),withCredentials:f},function(a,b){l(a,b,m.media().uri)}))}),k=d({uri:e,withCredentials:f},function(g,h){var i,j;if(k=null,g)return m.error={status:h.status,message:"HLS playlist request error at URL: "+e,responseText:h.responseText,code:2},m.trigger("error");if(i=new b.m3u8.Parser,i.push(h.responseText),i.end(),m.state="HAVE_MASTER",i.manifest.uri=e,i.manifest.playlists){for(m.master=i.manifest,j=m.master.playlists.length;j--;)m.master.playlists[m.master.playlists[j].uri]=m.master.playlists[j];return k=d({uri:c(e,i.manifest.playlists[0].uri),withCredentials:f},function(a,b){l(a,b,i.manifest.playlists[0].uri),a||m.trigger("loadedmetadata")}),m.trigger("loadedplaylist")}return m.master={uri:a.location.href,playlists:[{uri:e}]},m.master.playlists[e]=m.master.playlists[0],l(null,h,e),m.trigger("loadedmetadata")})};i.prototype=new b.Hls.Stream,i.prototype.updateMediaPlaylist_=function(a){var b;this.media_&&(b=a.mediaSequence-this.media_.mediaSequence,this.expired_+=e.duration(this.media_,this.media_.mediaSequence,a.mediaSequence)),this.media_=this.master.playlists[a.uri]},i.prototype.updateTimelineOffset=function(a,b){var c=e.duration(this.media_,this.media_.mediaSequence,this.media_.mediaSequence+a);this.expired_=b-c},i.prototype.getMediaIndexForTime_=function(a){var b;if(!this.media_)return 0;if(a-=this.expired_,0>a)return 0;for(b=0;b<this.media_.segments.length;b++)if(a-=e.duration(this.media_,this.media_.mediaSequence+b,this.media_.mediaSequence+b+1,!1),0>=a)return b;return this.media_.segments.length-1},b.Hls.PlaylistLoader=i}(window,window.videojs),function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);throw new Error("Cannot find module '"+g+"'")}var j=c[g]={exports:{}};b[g][0].call(j.exports,function(a){var c=b[g][1][a];return e(c?c:a)},j,j.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){(function(b){b.window.pkcs7={unpad:a("./unpad")}}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./unpad":2}],2:[function(a,b,c){"use strict";b.exports=function(a){return a.subarray(0,a.byteLength-a[a.byteLength-1])}},{}]},{},[1]),function(a,b,c){"use strict";var d,e,f,g,h;h=function(a){return a<<24|(65280&a)<<8|(16711680&a)>>8|a>>>24},d=function(a){this._precompute();var b,c,d,e,f,g=this._tables[0][4],h=this._tables[1],i=a.length,j=1;if(4!==i&&6!==i&&8!==i)throw new Error("Invalid aes key size");for(e=a.slice(0),f=[],this._key=[e,f],b=i;4*i+28>b;b++)d=e[b-1],(b%i===0||8===i&&b%i===4)&&(d=g[d>>>24]<<24^g[d>>16&255]<<16^g[d>>8&255]<<8^g[255&d],b%i===0&&(d=d<<8^d>>>24^j<<24,j=j<<1^283*(j>>7))),e[b]=e[b-i]^d;for(c=0;b;c++,b--)d=e[3&c?b:b-4],4>=b||4>c?f[c]=d:f[c]=h[0][g[d>>>24]]^h[1][g[d>>16&255]]^h[2][g[d>>8&255]]^h[3][g[255&d]]},d.prototype={_tables:[[[],[],[],[],[]],[[],[],[],[],[]]],_precompute:function(){var a,b,c,d,e,f,g,h,i,j=this._tables[0],k=this._tables[1],l=j[4],m=k[4],n=[],o=[];for(a=0;256>a;a++)o[(n[a]=a<<1^283*(a>>7))^a]=a;for(b=c=0;!l[b];b^=d||1,c=o[c]||1)for(g=c^c<<1^c<<2^c<<3^c<<4,g=g>>8^255&g^99,l[b]=g,m[g]=b,f=n[e=n[d=n[b]]],i=16843009*f^65537*e^257*d^16843008*b,h=257*n[g]^16843008*g,a=0;4>a;a++)j[a][b]=h=h<<24^h>>>8,k[a][g]=i=i<<24^i>>>8;for(a=0;5>a;a++)j[a]=j[a].slice(0),k[a]=k[a].slice(0)},decrypt:function(a,b,c,d,e,f){var g,h,i,j,k=this._key[1],l=a^k[0],m=d^k[1],n=c^k[2],o=b^k[3],p=k.length/4-2,q=4,r=this._tables[1],s=r[0],t=r[1],u=r[2],v=r[3],w=r[4];for(j=0;p>j;j++)g=s[l>>>24]^t[m>>16&255]^u[n>>8&255]^v[255&o]^k[q],h=s[m>>>24]^t[n>>16&255]^u[o>>8&255]^v[255&l]^k[q+1],i=s[n>>>24]^t[o>>16&255]^u[l>>8&255]^v[255&m]^k[q+2],o=s[o>>>24]^t[l>>16&255]^u[m>>8&255]^v[255&n]^k[q+3],q+=4,l=g,m=h,n=i;for(j=0;4>j;j++)e[(3&-j)+f]=w[l>>>24]<<24^w[m>>16&255]<<16^w[n>>8&255]<<8^w[255&o]^k[q++],g=l,l=m,m=n,n=o,o=g}},g=function(a,b,c){var e,f,g,i,j,k,l,m,n,o=new Int32Array(a.buffer,a.byteOffset,a.byteLength>>2),p=new d(Array.prototype.slice.call(b)),q=new Uint8Array(a.byteLength),r=new Int32Array(q.buffer);for(e=c[0],f=c[1],g=c[2],i=c[3],n=0;n<o.length;n+=4)j=h(o[n]),k=h(o[n+1]),l=h(o[n+2]),m=h(o[n+3]),p.decrypt(j,k,l,m,r,n),r[n]=h(r[n]^e),r[n+1]=h(r[n+1]^f),r[n+2]=h(r[n+2]^g),r[n+3]=h(r[n+3]^i),e=j,f=k,g=l,i=m;return q},e=function(){this.jobs=[],this.delay=1,this.timeout_=null},e.prototype=new b.Hls.Stream,e.prototype.processJob_=function(){this.jobs.shift()(),this.jobs.length?this.timeout_=setTimeout(this.processJob_.bind(this),this.delay):this.timeout_=null},e.prototype.push=function(a){this.jobs.push(a),this.timeout_||(this.timeout_=setTimeout(this.processJob_.bind(this),this.delay))},f=function(a,b,d,g){var i=f.STEP,j=new Int32Array(a.buffer),k=new Uint8Array(a.byteLength),l=0;for(this.asyncStream_=new e,this.asyncStream_.push(this.decryptChunk_(j.subarray(l,l+i),b,d,k,l)),l=i;l<j.length;l+=i)d=new Uint32Array([h(j[l-4]),h(j[l-3]),h(j[l-2]),h(j[l-1])]),this.asyncStream_.push(this.decryptChunk_(j.subarray(l,l+i),b,d,k));this.asyncStream_.push(function(){g(null,c(k))})},f.prototype=new b.Hls.Stream,f.prototype.decryptChunk_=function(a,b,c,d){return function(){var e=g(a,b,c);d.set(e,a.byteOffset)}},f.STEP=32e3,b.Hls.decrypt=g,b.Hls.Decrypter=f,b.Hls.AsyncStream=e}(window,window.videojs,window.pkcs7.unpad);